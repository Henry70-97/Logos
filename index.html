<!doctype html>
<html lang="en" class="h-full">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Creativepay - Earn from Creative Writing</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="/_sdk/element_sdk.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&amp;display=swap" rel="stylesheet">
  <style>
    body {
      box-sizing: border-box;
      font-family: 'Plus Jakarta Sans', sans-serif;
    }
    
    .gradient-primary {
      background: linear-gradient(135deg, #10b981 0%, #ec4899 50%, #8b5cf6 100%);
    }
    
    .gradient-card {
      background: linear-gradient(135deg, #10b981 0%, #14b8a6 50%, #8b5cf6 100%);
    }
    
    .gradient-text {
      background: linear-gradient(135deg, #10b981, #ec4899, #8b5cf6);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .floating-shape {
      position: absolute;
      border-radius: 50%;
      opacity: 0.1;
      animation: float 6s ease-in-out infinite;
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(5deg); }
    }
    
    .card-soft-1 { background: linear-gradient(135deg, #ecfdf5 0%, #f0fdf4 100%); }
    .card-soft-2 { background: linear-gradient(135deg, #fdf2f8 0%, #fce7f3 100%); }
    .card-soft-3 { background: linear-gradient(135deg, #f5f3ff 0%, #ede9fe 100%); }
    .card-soft-4 { background: linear-gradient(135deg, #f0fdfa 0%, #ccfbf1 100%); }
    
    .slide-in {
      animation: slideIn 0.3s ease-out;
    }
    
    @keyframes slideIn {
      from { transform: translateX(-100%); }
      to { transform: translateX(0); }
    }
    
    .fade-in {
      animation: fadeIn 0.3s ease-out;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .toast {
      animation: toastIn 0.3s ease-out, toastOut 0.3s ease-in 2.7s forwards;
    }
    
    @keyframes toastIn {
      from { transform: translateY(100%); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    @keyframes toastOut {
      from { transform: translateY(0); opacity: 1; }
      to { transform: translateY(100%); opacity: 0; }
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #10b981 0%, #14b8a6 100%);
      transition: all 0.3s ease;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
    }
    
    .input-field {
      transition: all 0.3s ease;
    }
    
    .input-field:focus {
      box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
    }

    .pdf-container {
      background: white;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
      max-height: 70vh;
      overflow-y: auto;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="h-full bg-amber-50/30 overflow-x-hidden">
  <div id="app" class="h-full w-full relative overflow-auto"><!-- Floating Shapes Background -->
   <div class="fixed inset-0 pointer-events-none overflow-hidden">
    <div class="floating-shape w-64 h-64 bg-green-500 top-10 -left-20" style="animation-delay: 0s;"></div>
    <div class="floating-shape w-48 h-48 bg-pink-500 top-1/4 right-10" style="animation-delay: 1s;"></div>
    <div class="floating-shape w-32 h-32 bg-purple-500 bottom-20 left-1/4" style="animation-delay: 2s;"></div>
    <div class="floating-shape w-56 h-56 bg-teal-500 bottom-1/3 -right-10" style="animation-delay: 1.5s;"></div>
   </div><!-- Toast Container -->
   <div id="toast-container" class="fixed bottom-4 left-1/2 -translate-x-1/2 z-50"></div><!-- Landing Page -->
   <div id="landing-page" class="min-h-full relative"><!-- Header -->
    <header class="sticky top-0 z-40 bg-white/80 backdrop-blur-lg border-b border-gray-100">
     <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center gap-2">
       <div class="w-10 h-10 gradient-primary rounded-xl flex items-center justify-center">
        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
        </svg>
       </div><span class="text-xl font-bold gradient-text" id="header-name">Creativepay</span>
      </div><button onclick="showPage('registration')" class="btn-primary text-white px-4 py-2 rounded-full text-sm font-semibold"> Get Started </button>
     </div>
    </header><!-- Hero Section -->
    <section class="px-4 py-12 md:py-20 max-w-7xl mx-auto">
     <div class="text-center max-w-3xl mx-auto">
      <div class="inline-flex items-center gap-2 bg-green-100 text-green-700 px-4 py-2 rounded-full text-sm font-medium mb-6"><span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span> Now Accepting Kenyan Writers
      </div>
      <h1 class="text-4xl md:text-6xl font-extrabold text-gray-900 mb-6 leading-tight">Turn Your <span class="gradient-text">Creative Writing</span> Into Real Earnings</h1>
      <p class="text-lg md:text-xl text-gray-600 mb-8" id="hero-tagline">Join thousands of Kenyan writers earning from short stories, essays, and literature tasks. Get paid $2 per page (250 words).</p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center"><button onclick="showPage('registration')" class="btn-primary text-white px-8 py-4 rounded-2xl text-lg font-bold shadow-lg"> Start Earning Today </button> <button onclick="showPage('registration')" class="bg-white text-gray-700 px-8 py-4 rounded-2xl text-lg font-semibold border-2 border-gray-200 hover:border-green-300 transition-all"> View Writing Tasks </button>
      </div>
     </div><!-- Stats -->
     <div class="grid grid-cols-3 gap-4 mt-12 max-w-2xl mx-auto">
      <div class="bg-white rounded-2xl p-4 text-center shadow-sm">
       <p class="text-2xl md:text-3xl font-bold gradient-text">5K+</p>
       <p class="text-gray-500 text-sm">Active Writers</p>
      </div>
      <div class="bg-white rounded-2xl p-4 text-center shadow-sm">
       <p class="text-2xl md:text-3xl font-bold gradient-text">$50K+</p>
       <p class="text-gray-500 text-sm">Paid Out</p>
      </div>
      <div class="bg-white rounded-2xl p-4 text-center shadow-sm">
       <p class="text-2xl md:text-3xl font-bold gradient-text">500+</p>
       <p class="text-gray-500 text-sm">Tasks Daily</p>
      </div>
     </div>
    </section><!-- Features -->
    <section class="px-4 py-12 bg-white/50">
     <div class="max-w-7xl mx-auto">
      <h2 class="text-3xl font-bold text-center mb-12">Why Writers Choose <span class="gradient-text">Creativepay</span></h2>
      <div class="grid md:grid-cols-3 gap-6">
       <div class="card-soft-1 rounded-3xl p-6 hover:shadow-lg transition-all">
        <div class="w-14 h-14 bg-green-500 rounded-2xl flex items-center justify-center mb-4">
         <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
         </svg>
        </div>
        <h3 class="text-xl font-bold mb-2">Instant Payments</h3>
        <p class="text-gray-600">Get paid immediately after your task is approved. Withdraw to M-Pesa or Bank.</p>
       </div>
       <div class="card-soft-2 rounded-3xl p-6 hover:shadow-lg transition-all">
        <div class="w-14 h-14 bg-pink-500 rounded-2xl flex items-center justify-center mb-4">
         <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
         </svg>
        </div>
        <h3 class="text-xl font-bold mb-2">Kenyan Literature Focus</h3>
        <p class="text-gray-600">Tasks based on African literature, set books, and creative storytelling.</p>
       </div>
       <div class="card-soft-3 rounded-3xl p-6 hover:shadow-lg transition-all">
        <div class="w-14 h-14 bg-purple-500 rounded-2xl flex items-center justify-center mb-4">
         <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
         </svg>
        </div>
        <h3 class="text-xl font-bold mb-2">Flexible Schedule</h3>
        <p class="text-gray-600">Work anytime, anywhere. Choose tasks that match your expertise.</p>
       </div>
      </div>
     </div>
    </section><!-- Footer -->
    <footer class="bg-gray-900 text-white px-4 py-12">
     <div class="max-w-7xl mx-auto">
      <div class="flex flex-col md:flex-row justify-between items-center gap-6">
       <div class="flex items-center gap-2">
        <div class="w-10 h-10 gradient-primary rounded-xl flex items-center justify-center">
         <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
         </svg>
        </div><span class="text-xl font-bold">Creativepay</span>
       </div>
       <div class="flex gap-6 text-sm text-gray-400"><a href="#" class="hover:text-white transition-colors">Terms</a> <a href="#" class="hover:text-white transition-colors">Privacy</a> <a href="#" onclick="event.preventDefault(); showPage('support');" class="hover:text-white transition-colors">Contact</a>
       </div>
       <div class="flex gap-4"><a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-gray-700 transition-colors">
         <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 24 24">
          <path d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z" />
         </svg></a> <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-gray-700 transition-colors">
         <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 24 24">
          <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
         </svg></a> <a href="https://chat.whatsapp.com/BB9RnEv8b5E9AuOafdAac6?mode=gi_t" target="_blank" rel="noopener noreferrer" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-green-600 transition-colors">
         <svg class="w-5 h-5" fill="currentColor" viewbox="0 0 24 24">
          <path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z" />
         </svg></a>
       </div>
      </div>
      <p class="text-center text-gray-500 text-sm mt-8">¬© 2024 Creativepay. All rights reserved.</p>
     </div>
    </footer>
   </div><!-- Registration Page -->
   <div id="registration-page" class="min-h-full hidden">
    <div class="min-h-full flex items-center justify-center px-4 py-12">
     <div class="w-full max-w-md">
      <div class="bg-white rounded-3xl shadow-xl p-8 fade-in">
       <div class="text-center mb-8">
        <div class="w-16 h-16 gradient-primary rounded-2xl flex items-center justify-center mx-auto mb-4">
         <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
         </svg>
        </div>
        <h2 class="text-2xl font-bold text-gray-900">Create Your Account</h2>
        <p class="text-gray-500 mt-2">Start earning from your writing today</p>
       </div>
       <form id="registration-form" class="space-y-4">
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Full Name</label> <input type="text" name="fullName" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="John Kamau">
        </div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Email Address</label> <input type="email" name="email" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="john@example.com">
        </div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label> <input type="tel" name="phone" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="0712345678">
        </div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Password</label> <input type="password" name="password" required minlength="6" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        </div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Confirm Password</label> <input type="password" name="confirmPassword" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
        </div><button type="submit" class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg"> Create Account </button>
       </form>
       <p class="text-center text-gray-500 text-sm mt-6">Already have an account? <a href="#" onclick="event.preventDefault(); showPage('landing');" class="text-green-600 font-semibold">Sign In</a></p>
      </div>
     </div>
    </div>
   </div><!-- Declaration Page -->
   <div id="declaration-page" class="min-h-full hidden">
    <div class="min-h-full flex items-center justify-center px-4 py-12">
     <div class="w-full max-w-md">
      <div class="bg-white rounded-3xl shadow-xl p-8 fade-in">
       <div class="text-center mb-8">
        <div class="w-16 h-16 bg-purple-500 rounded-2xl flex items-center justify-center mx-auto mb-4">
         <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
         </svg>
        </div>
        <h2 class="text-2xl font-bold text-gray-900">Writer's Declaration</h2>
        <p class="text-gray-500 mt-2">Please read and accept our terms</p>
       </div>
       <div class="card-soft-3 rounded-2xl p-4 mb-6 max-h-64 overflow-y-auto text-sm text-gray-600">
        <h3 class="font-bold text-gray-900 mb-2">Terms of Service</h3>
        <ul class="space-y-2 list-disc pl-4">
         <li>All submitted work must be 100% original and plagiarism-free.</li>
         <li>Payment is processed within 24-48 hours after task approval.</li>
         <li>Minimum withdrawal amount is $5 (KES 650).</li>
         <li>Writers must maintain a quality rating of 3.5 stars or above.</li>
         <li>Submitting AI-generated content without disclosure is prohibited.</li>
         <li>All tasks must be completed within the specified deadline.</li>
         <li>Creativepay retains the right to reject substandard submissions.</li>
         <li>Writers are responsible for their own tax obligations.</li>
         <li>Account sharing or multiple accounts are not permitted.</li>
         <li>Respectful communication with clients is mandatory.</li>
        </ul>
       </div>
       <div class="flex items-start gap-3 mb-6"><input type="checkbox" id="accept-terms" class="mt-1 w-5 h-5 text-green-500 rounded"> <label for="accept-terms" class="text-sm text-gray-600"> I have read and agree to the <span class="text-green-600 font-semibold">Terms of Service</span> and <span class="text-green-600 font-semibold">Privacy Policy</span> </label>
       </div><button onclick="handleDeclaration()" class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg"> Accept &amp; Continue </button>
      </div>
     </div>
    </div>
   </div><!-- Verification Page -->
   <div id="verification-page" class="min-h-full hidden">
    <div class="min-h-full flex items-center justify-center px-4 py-12">
     <div class="w-full max-w-md">
      <div class="bg-white rounded-3xl shadow-xl p-8 fade-in">
       <div class="text-center mb-8">
        <div class="w-16 h-16 bg-teal-500 rounded-2xl flex items-center justify-center mx-auto mb-4">
         <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z" />
         </svg>
        </div>
        <h2 class="text-2xl font-bold text-gray-900">Identity Verification</h2>
        <p class="text-gray-500 mt-2">Verify your identity to start earning</p>
       </div>
       <form id="verification-form" class="space-y-4">
        <div><label class="block text-sm font-medium text-gray-700 mb-2">ID Type</label> <select name="idType" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none"> <option value="">Select ID Type</option> <option value="national_id">National ID</option> <option value="passport">Passport</option> <option value="driving_license">Driving License</option> </select>
        </div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">ID Number</label> <input type="text" name="idNumber" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="Enter your ID number">
        </div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Date of Birth</label> <input type="date" name="dob" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none">
        </div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">County</label> <input type="text" name="county" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="e.g., Nairobi">
        </div><button type="submit" class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg"> Submit Verification </button> <button type="button" onclick="skipVerification()" class="w-full bg-gray-100 text-gray-700 py-4 rounded-xl font-bold text-lg hover:bg-gray-200 transition-colors"> Skip for Now </button>
       </form>
      </div>
     </div>
    </div>
   </div><!-- Payment Setup Page -->
   <div id="payment-setup-page" class="min-h-full hidden">
    <div class="min-h-full flex items-center justify-center px-4 py-12">
     <div class="w-full max-w-md">
      <div class="bg-white rounded-3xl shadow-xl p-8 fade-in">
       <div class="text-center mb-8">
        <div class="w-16 h-16 bg-pink-500 rounded-2xl flex items-center justify-center mx-auto mb-4">
         <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z" />
         </svg>
        </div>
        <h2 class="text-2xl font-bold text-gray-900">Payment Setup</h2>
        <p class="text-gray-500 mt-2">Add your withdrawal details</p>
       </div>
       <form id="payment-form" class="space-y-4">
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Payment Method</label> <select name="paymentMethod" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" onchange="togglePaymentFields(this.value)"> <option value="">Select Method</option> <option value="mpesa">M-Pesa</option> <option value="bank">Bank Transfer</option> <option value="paypal">PayPal</option> </select>
        </div>
        <div id="mpesa-fields" class="hidden space-y-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">M-Pesa Phone Number</label> <input type="tel" name="mpesaPhone" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="0712345678">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">M-Pesa Name</label> <input type="text" name="mpesaName" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="As registered on M-Pesa">
         </div>
        </div>
        <div id="bank-fields" class="hidden space-y-4">
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Bank Name</label> <input type="text" name="bankName" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="e.g., KCB Bank">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Account Number</label> <input type="text" name="accountNumber" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="Your account number">
         </div>
         <div><label class="block text-sm font-medium text-gray-700 mb-2">Account Name</label> <input type="text" name="accountName" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="Name on account">
         </div>
        </div>
        <div id="paypal-fields" class="hidden"><label class="block text-sm font-medium text-gray-700 mb-2">PayPal Email</label> <input type="email" name="paypalEmail" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="your@paypal.com">
        </div><button type="submit" class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg"> Complete Setup </button>
       </form>
      </div>
     </div>
    </div>
   </div><!-- Dashboard Page -->
   <div id="dashboard-page" class="min-h-full hidden"><!-- Mobile Menu Overlay -->
    <div id="menu-overlay" class="fixed inset-0 bg-black/50 z-40 hidden" onclick="toggleMenu()"></div><!-- Side Menu -->
    <div id="side-menu" class="fixed left-0 top-0 h-full w-72 bg-white shadow-2xl z-50 -translate-x-full transition-transform duration-300">
     <div class="p-6">
      <div class="flex items-center justify-between mb-8">
       <div class="flex items-center gap-2">
        <div class="w-10 h-10 gradient-primary rounded-xl flex items-center justify-center">
         <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
         </svg>
        </div><span class="text-lg font-bold gradient-text">Creativepay</span>
       </div><button onclick="toggleMenu()" class="p-2 hover:bg-gray-100 rounded-lg">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg></button>
      </div>
      <nav class="space-y-2"><a href="#" onclick="event.preventDefault(); setActiveSection('home'); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors" data-section="home">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
        </svg><span class="font-medium text-gray-700">Home</span> </a> <a href="#" onclick="event.preventDefault(); setActiveSection('tasks'); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors" data-section="tasks">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01" />
        </svg><span class="font-medium text-gray-700">Available Tasks</span> </a> <a href="#" onclick="event.preventDefault(); setActiveSection('submit'); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors" data-section="submit">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
        </svg><span class="font-medium text-gray-700">Submit Task</span> </a> <a href="#" onclick="event.preventDefault(); showMyTasks(); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4" />
        </svg><span class="font-medium text-gray-700">My Tasks</span> </a> <a href="#" onclick="event.preventDefault(); setActiveSection('earnings'); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors" data-section="earnings">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
        </svg><span class="font-medium text-gray-700">Earnings</span> </a> <a href="#" onclick="event.preventDefault(); showPage('withdraw'); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" />
        </svg><span class="font-medium text-gray-700">Withdraw</span> </a> <a href="#" onclick="event.preventDefault(); showPage('support'); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg><span class="font-medium text-gray-700">Support</span> </a> <a href="#" onclick="event.preventDefault(); setActiveSection('invest'); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors" data-section="invest">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
        </svg><span class="font-medium text-gray-700">Invest &amp; Cashback</span> </a> <a href="#" onclick="event.preventDefault(); setActiveSection('subscription'); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors" data-section="subscription">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z" />
        </svg><span class="font-medium text-gray-700">Subscription</span> </a> <a href="https://chat.whatsapp.com/BB9RnEv8b5E9AuOafdAac6?mode=gi_t" target="_blank" rel="noopener noreferrer" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors">
        <svg class="w-5 h-5 text-green-500" fill="currentColor" viewbox="0 0 24 24"><path d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.392 1.592 5.448 0 9.886-4.434 9.889-9.885.002-5.462-4.415-9.89-9.881-9.892-5.452 0-9.887 4.434-9.889 9.884-.001 2.225.651 3.891 1.746 5.634l-.999 3.648 3.742-.981zm11.387-5.464c-.074-.124-.272-.198-.57-.347-.297-.149-1.758-.868-2.031-.967-.272-.099-.47-.149-.669.149-.198.297-.768.967-.941 1.165-.173.198-.347.223-.644.074-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.297-.347.446-.521.151-.172.2-.296.3-.495.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.206-.242-.579-.487-.501-.669-.51l-.57-.01c-.198 0-.52.074-.792.372s-1.04 1.016-1.04 2.479 1.065 2.876 1.213 3.074c.149.198 2.095 3.2 5.076 4.487.709.306 1.263.489 1.694.626.712.226 1.36.194 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.695.248-1.29.173-1.414z" />
        </svg><span class="font-medium text-green-600">Meet Other Writers</span> </a> <a href="#" onclick="event.preventDefault(); showPage('refund'); toggleMenu();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-gray-100 transition-colors">
        <svg class="w-5 h-5 text-gray-500" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6" />
        </svg><span class="font-medium text-gray-700">Refund</span> </a>
       <div class="border-t border-gray-200 my-4"></div><a href="#" onclick="event.preventDefault(); handleLogout();" class="menu-item flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-red-50 transition-colors text-red-600">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
        </svg><span class="font-medium">Logout</span> </a>
      </nav>
     </div>
    </div><!-- Dashboard Header -->
    <header class="sticky top-0 z-30 bg-white/80 backdrop-blur-lg border-b border-gray-100">
     <div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between"><button onclick="toggleMenu()" class="p-2 hover:bg-gray-100 rounded-xl">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
       </svg></button>
      <div class="flex items-center gap-2">
       <div class="w-8 h-8 gradient-primary rounded-lg flex items-center justify-center">
        <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
        </svg>
       </div><span class="font-bold gradient-text">Creativepay</span>
      </div>
      <div class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center"><span class="text-sm font-bold text-gray-600" id="user-avatar">JK</span>
      </div>
     </div>
    </header><!-- Dashboard Content -->
    <main class="max-w-7xl mx-auto px-4 py-6 pb-24"><!-- Home Section -->
     <section id="section-home" class="dashboard-section"><!-- Welcome Card -->
      <div class="card-soft-1 rounded-3xl p-6 mb-6">
       <p class="text-gray-600">Welcome back,</p>
       <h2 class="text-2xl font-bold text-gray-900" id="user-name-display">John Kamau</h2>
       <p class="text-sm text-gray-500 mt-1">Ready to write something amazing? üìù</p>
      </div><!-- Balance Card -->
      <div class="gradient-card rounded-3xl p-6 text-white shadow-xl mb-6">
       <div class="flex justify-between items-start mb-4">
        <div>
         <p class="text-white/80 text-sm">Total Earnings</p>
         <h3 class="text-4xl font-bold mt-1" id="balance-display">$25.00</h3>
        </div><button onclick="toggleCurrency()" class="bg-white/20 px-3 py-1 rounded-full text-sm font-medium hover:bg-white/30 transition-colors" id="currency-toggle"> USD </button>
       </div>
       <div class="flex gap-3 mt-6"><button onclick="setActiveSection('tasks')" class="flex-1 bg-white text-green-600 py-3 rounded-xl font-bold hover:bg-white/90 transition-colors"> Start Writing </button> <button onclick="showPage('withdraw')" class="flex-1 bg-white/20 text-white py-3 rounded-xl font-bold hover:bg-white/30 transition-colors border border-white/30"> Withdraw </button>
       </div>
      </div><!-- Welcome Bonus -->
      <div id="welcome-bonus-card" class="card-soft-2 rounded-3xl p-6 mb-6 hidden">
       <div class="flex items-center gap-4">
        <div class="w-14 h-14 bg-pink-500 rounded-2xl flex items-center justify-center">
         <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v13m0-13V6a2 2 0 112 2h-2zm0 0V5.5A2.5 2.5 0 109.5 8H12zm-7 4h14M5 12a2 2 0 110-4h14a2 2 0 110 4M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7" />
         </svg>
        </div>
        <div class="flex-1">
         <h3 class="font-bold text-gray-900">Welcome Bonus! üéâ</h3>
         <p class="text-gray-600 text-sm">Complete your first task to earn a bonus!</p>
        </div><button onclick="claimWelcomeBonus()" class="btn-primary text-white px-4 py-2 rounded-xl font-semibold text-sm"> Claim </button>
       </div>
      </div><!-- Recent Activity -->
      <div class="bg-white rounded-3xl p-6 shadow-sm">
       <h3 class="font-bold text-gray-900 mb-4">Recent Activity</h3>
       <div class="space-y-3" id="activity-list"><!-- Activity items will be dynamically populated -->
       </div>
      </div>
     </section><!-- Tasks Section -->
     <section id="section-tasks" class="dashboard-section hidden">
      <div class="mb-6">
       <h2 class="text-2xl font-bold text-gray-900">Available Tasks</h2>
       <p class="text-gray-500">Choose a task and start earning</p>
      </div><!-- Task Category Tabs -->
      <div class="flex gap-2 mb-6 overflow-x-auto pb-2"><button onclick="filterTasks('all')" class="task-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-900 text-white whitespace-nowrap" data-tab="all"> All Tasks </button> <button onclick="filterTasks('short-story')" class="task-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-600 whitespace-nowrap" data-tab="short-story"> Short Stories </button> <button onclick="filterTasks('essay')" class="task-tab px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-600 whitespace-nowrap" data-tab="essay"> Essays </button>
      </div><!-- Tasks List -->
      <div id="tasks-list" class="grid grid-cols-1 md:grid-cols-2 gap-4"><!-- Tasks will be populated by JavaScript -->
      </div>
     </section><!-- Submit Section -->
     <section id="section-submit" class="dashboard-section hidden">
      <div class="mb-6">
       <h2 class="text-2xl font-bold text-gray-900">Submit Task</h2>
       <p class="text-gray-500">Upload your completed work</p>
      </div>
      <div class="bg-white rounded-3xl p-6 shadow-sm">
       <form id="submit-task-form" class="space-y-4">
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Task ID</label> <input type="text" name="taskId" id="submit-task-id" required readonly class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 bg-gray-50 cursor-not-allowed" placeholder="Select a task first">
        </div>
        <div id="task-info-display" class="hidden card-soft-1 rounded-xl p-4 space-y-2">
         <div class="flex justify-between text-sm"><span class="text-gray-600">Task Title:</span> <span class="font-semibold" id="display-task-title"></span>
         </div>
         <div class="flex justify-between text-sm"><span class="text-gray-600">Required Words:</span> <span class="font-semibold" id="display-task-words"></span>
         </div>
         <div class="flex justify-between text-sm"><span class="text-gray-600">Payment:</span> <span class="font-semibold text-green-600" id="display-task-payment"></span>
         </div>
         <div class="bg-orange-50 border-2 border-orange-200 rounded-lg p-3 mt-3">
          <div class="flex items-center gap-2 mb-2">
           <svg class="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
           </svg><span class="text-sm font-bold text-orange-900">Deadline:</span>
          </div>
          <p class="text-2xl font-black text-orange-600 mb-1" id="deadline-countdown">Loading...</p>
          <p class="text-xs text-orange-700 font-semibold">‚ö†Ô∏è Late submission: 2% fine from your balance</p>
         </div>
        </div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Upload Document (Optional)</label> <input type="file" accept=".doc,.docx,.txt,.pdf" id="file-upload" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none">
         <p class="text-xs text-gray-400 mt-1">Supported: DOC, DOCX, TXT, PDF</p>
        </div>
        <div><label class="block text-sm font-medium text-gray-700 mb-2">Your Work</label> <textarea name="submission" id="submission-textarea" required rows="10" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none resize-none" placeholder="Paste your completed story or essay here..."></textarea>
        </div>
        <div class="card-soft-3 rounded-xl p-4">
         <div class="flex justify-between items-center"><span class="text-sm font-medium text-gray-700">Word Count:</span> <span class="text-2xl font-bold text-purple-600" id="word-count-display">0</span>
         </div>
         <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
          <div id="word-count-progress" class="bg-purple-500 h-2 rounded-full transition-all" style="width: 0%"></div>
         </div>
         <p class="text-xs text-gray-500 mt-1" id="word-count-status">Start typing to count words</p>
        </div><button type="submit" class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg"> Submit for Review </button>
       </form>
      </div>
     </section><!-- Earnings Section -->
     <section id="section-earnings" class="dashboard-section hidden">
      <div class="mb-6">
       <h2 class="text-2xl font-bold text-gray-900">Earnings History</h2>
       <p class="text-gray-500">Track your writing income</p>
      </div><!-- Earnings Summary -->
      <div class="grid grid-cols-2 gap-4 mb-6">
       <div class="card-soft-1 rounded-2xl p-4">
        <p class="text-sm text-gray-500">This Week</p>
        <p class="text-2xl font-bold text-gray-900">$12.00</p>
       </div>
       <div class="card-soft-2 rounded-2xl p-4">
        <p class="text-sm text-gray-500">This Month</p>
        <p class="text-2xl font-bold text-gray-900">$25.00</p>
       </div>
       <div class="card-soft-3 rounded-2xl p-4">
        <p class="text-sm text-gray-500">Tasks Completed</p>
        <p class="text-2xl font-bold text-gray-900">8</p>
       </div>
       <div class="card-soft-4 rounded-2xl p-4">
        <p class="text-sm text-gray-500">Avg. Rating</p>
        <p class="text-2xl font-bold text-gray-900">4.8 ‚≠ê</p>
       </div>
      </div><!-- Earnings List -->
      <div class="bg-white rounded-3xl p-6 shadow-sm">
       <h3 class="font-bold text-gray-900 mb-4">Transaction History</h3>
       <div class="space-y-3">
        <div class="flex items-center justify-between p-3 card-soft-1 rounded-xl">
         <div>
          <p class="font-medium text-gray-900">River and the Source Essay</p>
          <p class="text-sm text-gray-500">Dec 15, 2024</p>
         </div>
         <p class="font-bold text-green-600">+$4.00</p>
        </div>
        <div class="flex items-center justify-between p-3 card-soft-2 rounded-xl">
         <div>
          <p class="font-medium text-gray-900">Creative Short Story</p>
          <p class="text-sm text-gray-500">Dec 14, 2024</p>
         </div>
         <p class="font-bold text-green-600">+$6.00</p>
        </div>
        <div class="flex items-center justify-between p-3 card-soft-3 rounded-xl">
         <div>
          <p class="font-medium text-gray-900">Blossoms of the Savannah</p>
          <p class="text-sm text-gray-500">Dec 12, 2024</p>
         </div>
         <p class="font-bold text-green-600">+$4.00</p>
        </div>
        <div class="flex items-center justify-between p-3 card-soft-4 rounded-xl">
         <div>
          <p class="font-medium text-gray-900">Referral Bonus</p>
          <p class="text-sm text-gray-500">Dec 10, 2024</p>
         </div>
         <p class="font-bold text-green-600">+$1.00</p>
        </div>
       </div>
      </div>
     </section><!-- Invest Section -->
     <section id="section-invest" class="dashboard-section hidden">
      <div class="mb-6">
       <h2 class="text-2xl font-bold text-gray-900">Invest &amp; Cashback</h2>
       <p class="text-gray-500">Grow your earnings</p>
      </div>
      <div class="card-soft-3 rounded-3xl p-6 mb-6">
       <div class="flex items-center gap-4 mb-4">
        <div class="w-14 h-14 bg-purple-500 rounded-2xl flex items-center justify-center">
         <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
         </svg>
        </div>
        <div>
         <h3 class="font-bold text-gray-900">Earn 5% Cashback</h3>
         <p class="text-gray-600 text-sm">On every task you complete this month!</p>
        </div>
       </div>
       <div class="bg-white rounded-2xl p-4">
        <div class="flex justify-between mb-2"><span class="text-gray-600">Cashback earned</span> <span class="font-bold text-purple-600">$1.25</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2">
         <div class="bg-purple-500 h-2 rounded-full" style="width: 25%"></div>
        </div>
        <p class="text-xs text-gray-400 mt-2">Complete 10 more tasks to unlock bonus tier!</p>
       </div>
      </div>
      <div class="bg-white rounded-3xl p-6 shadow-sm">
       <h3 class="font-bold text-gray-900 mb-4">Refer &amp; Earn</h3>
       <p class="text-gray-600 mb-4">Invite friends and earn $1 for each friend who completes their first task!</p>
       <div class="card-soft-1 rounded-xl p-4 mb-4">
        <p class="text-sm text-gray-500 mb-1">Your Referral Code</p>
        <p class="text-xl font-bold text-gray-900">WRITE2024</p>
       </div><button onclick="copyReferralCode()" class="btn-primary w-full text-white py-3 rounded-xl font-bold"> Copy Referral Link </button>
      </div>
     </section><!-- Subscription Section -->
     <section id="section-subscription" class="dashboard-section hidden"><!-- Plan Selection View -->
      <div id="plan-selection-view">
       <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-900">Subscription Plans</h2>
        <p class="text-gray-500">Choose your plan to start submitting tasks</p>
       </div>
       <div class="space-y-4">
        <div class="bg-white rounded-3xl p-6 shadow-sm border-2 border-gray-200">
         <div class="flex justify-between items-start mb-4">
          <div>
           <h3 class="font-bold text-gray-900 text-lg">Basic Plan</h3>
           <p class="text-3xl font-bold text-green-600 mt-2">KES 310</p>
           <p class="text-gray-500 text-sm">One-time payment</p>
          </div><span class="bg-green-100 text-green-600 px-3 py-1 rounded-full text-sm font-medium">Popular</span>
         </div>
         <ul class="space-y-2 text-gray-600 mb-6">
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg> Access to all tasks</li>
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg> Submit unlimited tasks</li>
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg> Standard support</li>
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
           </svg><span class="text-gray-400">Priority task access</span></li>
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5 text-gray-300" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
           </svg><span class="text-gray-400">10% bonus earnings</span></li>
         </ul><button onclick="selectSubscription('basic', 310)" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold transition-colors"> Choose Basic </button>
        </div>
        <div class="gradient-card rounded-3xl p-6 text-white relative overflow-hidden">
         <div class="absolute top-0 right-0 bg-yellow-400 text-gray-900 px-4 py-1 text-sm font-bold rounded-bl-xl">
          PREMIUM
         </div>
         <div class="mb-4">
          <h3 class="font-bold text-xl">Premium Plan</h3>
          <p class="text-4xl font-bold mt-2">KES 489</p>
          <p class="text-white/80 text-sm">One-time payment</p>
         </div>
         <ul class="space-y-2 text-white/90 mb-6">
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg> All Basic features</li>
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg> Priority task access</li>
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg> 10% bonus on all earnings</li>
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg> Instant withdrawals</li>
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg> Premium support</li>
          <li class="flex items-center gap-2">
           <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
           </svg> Early access to new tasks</li>
         </ul><button onclick="selectSubscription('premium', 489)" class="w-full bg-white text-green-600 py-3 rounded-xl font-bold hover:bg-white/90 transition-colors"> Choose Premium </button>
        </div>
       </div>
      </div><!-- Payment View -->
      <div id="payment-view" class="hidden">
       <div class="mb-6"><button onclick="backToPlans()" class="flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4">
         <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
         </svg> Back to Plans </button>
        <h2 class="text-2xl font-bold text-gray-900">Complete Payment</h2>
        <p class="text-gray-500">Pay and confirm your subscription</p>
       </div>
       <div class="bg-white rounded-3xl p-6 shadow-sm mb-6">
        <div class="card-soft-1 rounded-2xl p-4 mb-6">
         <div class="flex justify-between items-center mb-2"><span class="text-gray-600">Selected Plan:</span> <span class="font-bold text-gray-900" id="selected-plan-name">Basic Plan</span>
         </div>
         <div class="flex justify-between items-center"><span class="text-gray-600">Amount:</span> <span class="text-2xl font-bold text-green-600" id="selected-plan-amount">KES 310</span>
         </div>
        </div><button onclick="proceedToPayment()" class="w-full btn-primary text-white py-4 rounded-xl font-bold text-lg mb-4"> Pay Now </button>
        <div class="border-t border-gray-200 pt-6">
         <h3 class="font-bold text-gray-900 mb-4">Already Paid?</h3>
         <p class="text-sm text-gray-600 mb-4">Paste your payment confirmation message below to verify your subscription</p>
         <form id="payment-confirmation-form" class="space-y-4">
          <div><label class="block text-sm font-medium text-gray-700 mb-2">Full M-Pesa Confirmation Message</label> <textarea name="confirmationMessage" id="mpesa-confirmation-text" required rows="6" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none resize-none" placeholder="Paste the COMPLETE M-Pesa message here...

Example:
RP12ABC123 Confirmed. on 15/12/2024 at 2:45 PM Ksh310.00 sent to LIPANA TECHNOLOGIES LIMITED for account Subscription Payment. New M-PESA balance is Ksh2,500.00. Transaction cost, Ksh0.00."></textarea>
           <p class="text-xs text-gray-500 mt-1">‚ö†Ô∏è Paste the entire message including transaction code, amount, recipient name, and date</p>
          </div>
          <div id="payment-validation-error" class="hidden bg-red-50 border border-red-200 rounded-xl p-3">
           <p class="text-red-700 text-sm font-medium">‚ùå Validation Failed</p>
           <p class="text-red-600 text-xs mt-1" id="validation-error-message"></p>
          </div><button type="submit" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-xl font-bold transition-colors"> Verify Payment </button>
         </form>
        </div>
       </div>
      </div>
     </section>
    </main>
   </div><!-- Withdraw Page -->
   <div id="withdraw-page" class="min-h-full hidden">
    <header class="sticky top-0 z-30 bg-white/80 backdrop-blur-lg border-b border-gray-100">
     <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-4"><button onclick="showPage('dashboard')" class="p-2 hover:bg-gray-100 rounded-xl">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
       </svg></button>
      <h1 class="text-lg font-bold">Withdraw Funds</h1>
     </div>
    </header>
    <div class="max-w-md mx-auto px-4 py-8">
     <div class="bg-white rounded-3xl p-6 shadow-sm fade-in">
      <div class="gradient-card rounded-2xl p-4 text-white mb-6">
       <p class="text-white/80 text-sm">Available Balance</p>
       <p class="text-3xl font-bold" id="withdraw-balance">$25.00</p>
      </div>
      <form id="withdraw-form" class="space-y-4">
       <div><label class="block text-sm font-medium text-gray-700 mb-2">Withdraw Amount (USD)</label> <input type="number" name="amount" id="withdraw-amount-input" required min="0.01" step="0.01" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="Enter amount">
        <p class="text-xs text-gray-400 mt-1">No minimum withdrawal</p>
       </div>
       <div class="card-soft-1 rounded-xl p-4">
        <div class="flex justify-between items-center"><span class="text-sm text-gray-600">You will receive (KES):</span> <span class="text-xl font-bold text-green-600" id="withdraw-kes-display">KES 0</span>
        </div>
        <p class="text-xs text-gray-500 mt-1">After deducting fees</p>
       </div>
       <div><label class="block text-sm font-medium text-gray-700 mb-2">Withdraw Currency</label> <select name="withdrawCurrency" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none"> <option value="USD">USD (Dollars)</option> <option value="KES">KES (Kenyan Shillings)</option> </select>
       </div>
       <div><label class="block text-sm font-medium text-gray-700 mb-2">Payment Method</label> <select name="method" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none"> <option value="">Select method</option> <option value="mpesa">M-Pesa</option> <option value="bank">Bank Transfer</option> <option value="paypal">PayPal</option> </select>
       </div>
       <div><label class="block text-sm font-medium text-gray-700 mb-2">Account Details</label> <input type="text" name="accountDetails" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="Phone/Account number">
       </div><button type="submit" class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg"> Continue to Confirmation </button>
      </form>
     </div>
    </div>
   </div><!-- Withdrawal Confirmation Modal -->
   <div id="withdrawal-confirmation-modal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="absolute inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-md bg-white rounded-3xl shadow-2xl overflow-hidden">
     <div class="p-6">
      <div class="text-center mb-6">
       <div class="w-16 h-16 bg-yellow-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
        <svg class="w-8 h-8 text-yellow-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
        </svg>
       </div>
       <h2 class="text-xl font-bold text-gray-900">Confirm Withdrawal</h2>
       <p class="text-gray-500 text-sm mt-2">Please review the details carefully</p>
      </div>
      <div class="space-y-3 mb-6">
       <div class="card-soft-1 rounded-xl p-4">
        <div class="flex justify-between text-sm mb-2"><span class="text-gray-600">Withdrawal Amount:</span> <span class="font-bold text-gray-900" id="confirm-amount">$0.00</span>
        </div>
        <div class="flex justify-between text-sm mb-2"><span class="text-gray-600">Platform Fee (1%):</span> <span class="font-medium text-gray-700" id="confirm-platform-fee">$0.00</span>
        </div>
        <div class="flex justify-between text-sm mb-2"><span class="text-gray-600">Transaction Fee (5%):</span> <span class="font-medium text-gray-700" id="confirm-transaction-fee">$0.00</span>
        </div>
        <div class="flex justify-between text-sm mb-2"><span class="text-gray-600">VAT (5%):</span> <span class="font-medium text-gray-700" id="confirm-vat">$0.00</span>
        </div>
        <div class="border-t border-gray-200 my-2"></div>
        <div class="flex justify-between text-base"><span class="font-semibold text-gray-900">You'll Receive:</span> <span class="font-bold text-green-600" id="confirm-final-amount">$0.00</span>
        </div>
       </div>
       <div class="card-soft-2 rounded-xl p-4">
        <div class="flex justify-between text-sm mb-1"><span class="text-gray-600">Payment Method:</span> <span class="font-medium" id="confirm-method">-</span>
        </div>
        <div class="flex justify-between text-sm"><span class="text-gray-600">Account Details:</span> <span class="font-medium" id="confirm-account">-</span>
        </div>
       </div>
      </div>
      <div id="withdrawal-processing" class="hidden mb-6">
       <div class="flex flex-col items-center">
        <div class="w-12 h-12 border-4 border-green-500 border-t-transparent rounded-full animate-spin mb-3"></div>
        <p class="text-gray-600 font-medium">Processing withdrawal...</p>
       </div>
      </div>
      <div id="withdrawal-buttons" class="flex gap-3"><button onclick="closeWithdrawalModal()" class="flex-1 bg-gray-100 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-200 transition-colors"> Cancel </button> <button onclick="confirmWithdrawal()" class="flex-1 btn-primary text-white py-3 rounded-xl font-semibold"> Confirm Withdrawal </button>
      </div>
     </div>
    </div>
   </div><!-- Support Page -->
   <div id="support-page" class="min-h-full hidden">
    <header class="sticky top-0 z-30 bg-white/80 backdrop-blur-lg border-b border-gray-100">
     <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-4"><button onclick="goBack()" class="p-2 hover:bg-gray-100 rounded-xl">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
       </svg></button>
      <h1 class="text-lg font-bold">Support</h1>
     </div>
    </header>
    <div class="max-w-md mx-auto px-4 py-8">
     <div class="bg-white rounded-3xl p-6 shadow-sm fade-in">
      <div class="text-center mb-6">
       <div class="w-16 h-16 bg-teal-500 rounded-2xl flex items-center justify-center mx-auto mb-4">
        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z" />
        </svg>
       </div>
       <h2 class="text-xl font-bold text-gray-900">How can we help?</h2>
       <p class="text-gray-500">We typically respond within 24 hours</p>
      </div>
      <form id="support-form" class="space-y-4">
       <div><label class="block text-sm font-medium text-gray-700 mb-2">Subject</label> <select name="subject" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none"> <option value="">Select a topic</option> <option value="payment">Payment Issue</option> <option value="task">Task Problem</option> <option value="account">Account Help</option> <option value="technical">Technical Issue</option> <option value="other">Other</option> </select>
       </div>
       <div><label class="block text-sm font-medium text-gray-700 mb-2">Your Message</label> <textarea name="message" required rows="5" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none resize-none" placeholder="Describe your issue..."></textarea>
       </div><button type="submit" class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg"> Send Message </button>
      </form>
     </div>
    </div>
   </div><!-- Refund Page -->
   <div id="refund-page" class="min-h-full hidden">
    <header class="sticky top-0 z-30 bg-white/80 backdrop-blur-lg border-b border-gray-100">
     <div class="max-w-7xl mx-auto px-4 py-3 flex items-center gap-4"><button onclick="showPage('dashboard')" class="p-2 hover:bg-gray-100 rounded-xl">
       <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
       </svg></button>
      <h1 class="text-lg font-bold">Request Refund</h1>
     </div>
    </header>
    <div class="max-w-md mx-auto px-4 py-8">
     <div class="bg-white rounded-3xl p-6 shadow-sm fade-in">
      <div class="card-soft-2 rounded-2xl p-4 mb-6">
       <p class="text-sm text-gray-600">Refunds are processed within 3-5 business days after approval. Please provide detailed information about your refund request.</p>
      </div>
      <form id="refund-form" class="space-y-4">
       <div><label class="block text-sm font-medium text-gray-700 mb-2">Transaction ID</label> <input type="text" name="transactionId" required class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="Enter transaction ID">
       </div>
       <div><label class="block text-sm font-medium text-gray-700 mb-2">Refund Amount ($)</label> <input type="number" name="refundAmount" required step="0.01" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none" placeholder="Amount to refund">
       </div>
       <div><label class="block text-sm font-medium text-gray-700 mb-2">Reason for Refund</label> <textarea name="reason" required rows="4" class="input-field w-full px-4 py-3 rounded-xl border border-gray-200 focus:border-green-500 focus:outline-none resize-none" placeholder="Please explain why you're requesting a refund..."></textarea>
       </div><button type="submit" class="btn-primary w-full text-white py-4 rounded-xl font-bold text-lg"> Submit Refund Request </button>
      </form>
     </div>
    </div>
   </div><!-- Task Details Modal -->
   <div id="task-modal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/50" onclick="closeTaskModal()"></div>
    <div class="absolute inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-2xl bg-white rounded-3xl shadow-2xl overflow-hidden">
     <div class="pdf-container"><!-- PDF Header -->
      <div class="bg-gradient-to-r from-green-500 to-teal-500 p-6 text-white relative"><button onclick="closeTaskModal()" class="absolute top-4 right-4 w-8 h-8 bg-white/20 hover:bg-white/30 rounded-lg flex items-center justify-center transition-colors">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg></button>
       <div class="flex items-center gap-3 mb-4">
        <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
         <svg class="w-7 h-7" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
         </svg>
        </div>
        <div>
         <h2 class="text-xl font-bold">CREATIVEPAY</h2>
         <p class="text-white/80 text-sm">Writing Task Assignment</p>
        </div>
       </div>
      </div><!-- PDF Content -->
      <div class="p-6" id="task-modal-content"><!-- Content populated by JS -->
      </div><!-- PDF Footer -->
      <div class="border-t border-gray-200 p-4 flex justify-between items-center bg-gray-50"><button onclick="downloadTaskPdf()" class="flex items-center gap-2 text-green-600 font-medium hover:text-green-700">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
        </svg> Download PDF </button>
       <div class="flex gap-3"><button onclick="closeTaskModal()" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-xl font-medium hover:bg-gray-300 transition-colors"> Close </button> <button onclick="acceptTask()" class="px-4 py-2 btn-primary text-white rounded-xl font-medium"> Accept Task </button>
       </div>
      </div>
     </div>
    </div>
   </div><!-- Live Review Modal -->
   <div id="live-review-modal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/50"></div>
    <div class="absolute inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-2xl bg-white rounded-3xl shadow-2xl overflow-hidden max-h-[90vh] overflow-y-auto">
     <div class="p-6">
      <div class="text-center mb-6">
       <div class="w-16 h-16 bg-purple-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
        <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
        </svg>
       </div>
       <h2 class="text-2xl font-bold text-gray-900">Task Review in Progress</h2>
       <p class="text-gray-500 mt-2">Your submission is being evaluated by our AI system</p>
      </div><!-- Progress Steps -->
      <div class="space-y-3" id="review-steps"><!-- Steps populated by JS -->
      </div><!-- Review Results -->
      <div id="review-results" class="hidden mt-6"><!-- Results populated by JS -->
      </div>
     </div>
    </div>
   </div><!-- My Tasks Section in Dashboard -->
   <div id="my-tasks-modal" class="fixed inset-0 z-50 hidden">
    <div class="absolute inset-0 bg-black/50" onclick="closeMyTasksModal()"></div>
    <div class="absolute inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-3xl bg-white rounded-3xl shadow-2xl overflow-hidden max-h-[90vh] overflow-y-auto">
     <div class="p-6">
      <div class="flex items-center justify-between mb-6">
       <h2 class="text-2xl font-bold text-gray-900">My Tasks</h2><button onclick="closeMyTasksModal()" class="p-2 hover:bg-gray-100 rounded-lg">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg></button>
      </div>
      <div id="my-tasks-list" class="space-y-4"><!-- Task list populated by JS -->
      </div>
     </div>
    </div>
   </div>
  </div>
  <script>
    // Constants
    const WEB3FORMS_KEY = '741555bd-85f5-47b0-91ce-c54b65af9109';
    const WEB3FORMS_EMAIL = 'londonmarkv@gmail.com';
    const PAYMENT_LINK = 'https://lipana.dev/pay/subscription-c7b1-1';
    const EXCHANGE_RATE = 129; // 1 USD = 129 KES

    // State
    let currentCurrency = 'USD';
    let totalEarnings = (Math.random() * (0.05 - 0.01) + 0.01); // Start with random bonus $0.01-$0.05
    let currentTaskData = null;
    let previousPage = 'dashboard';
    let selectedSubscriptionPlan = null;

    // Tasks Data
    const tasksData = [
      // Short Stories
      { id: 'SS001', type: 'short-story', title: 'The Lost Heritage', genre: 'African Fiction', client: 'KenyaLit Publishing', wordCount: 500, payment: 4.00, description: 'Write a short story about a young Maasai warrior discovering an ancient artifact that reveals secrets about his ancestors. The story should explore themes of identity, tradition vs modernity, and the importance of preserving cultural heritage.', book: 'Original Work', author: 'N/A' },
      { id: 'SS002', type: 'short-story', title: 'Nairobi Nights', genre: 'Urban Drama', client: 'City Stories Ltd', wordCount: 750, payment: 6.00, description: 'Create a compelling narrative set in modern Nairobi, following a street vendor who witnesses a crime and must decide whether to speak up. Explore themes of justice, courage, and community solidarity.', book: 'Original Work', author: 'N/A' },
      { id: 'SS003', type: 'short-story', title: 'The Fisherman\'s Daughter', genre: 'Coming of Age', client: 'Lake Region Press', wordCount: 500, payment: 4.00, description: 'Write about a young girl from a fishing village on Lake Victoria who dreams of becoming a doctor. The story should capture the challenges of pursuing education while respecting family traditions.', book: 'Original Work', author: 'N/A' },
      { id: 'SS004', type: 'short-story', title: 'Safari Dreams', genre: 'Adventure', client: 'Wildlife Tales', wordCount: 625, payment: 5.00, description: 'Craft an adventure story about a park ranger who forms an unlikely friendship with an orphaned elephant. Include elements of conservation and human-wildlife coexistence.', book: 'Original Work', author: 'N/A' },
      { id: 'SS005', type: 'short-story', title: 'The Tea Picker', genre: 'Social Drama', client: 'Highland Stories', wordCount: 500, payment: 4.00, description: 'Tell the story of a tea plantation worker who discovers a way to improve working conditions for her fellow laborers. Themes: empowerment, collective action, and hope.', book: 'Original Work', author: 'N/A' },
      { id: 'SS006', type: 'short-story', title: 'Mombasa Memories', genre: 'Historical Fiction', client: 'Coastal Heritage', wordCount: 750, payment: 6.00, description: 'Set in 1960s Mombasa during Kenya\'s independence, write about a Swahili family navigating the changes brought by a new nation. Include cultural details of coastal life.', book: 'Original Work', author: 'N/A' },
      { id: 'SS007', type: 'short-story', title: 'The Cyber Warrior', genre: 'Sci-Fi', client: 'Future Africa', wordCount: 625, payment: 5.00, description: 'Write a futuristic story set in 2050 Nairobi where a young hacker must save the city\'s digital infrastructure from a cyber attack. Blend technology with African culture.', book: 'Original Work', author: 'N/A' },
      { id: 'SS008', type: 'short-story', title: 'Grandmother\'s Secret', genre: 'Mystery', client: 'Riddle House', wordCount: 500, payment: 4.00, description: 'A mystery story where a college student returns to her rural home and discovers her grandmother\'s hidden past as a freedom fighter during colonialism.', book: 'Original Work', author: 'N/A' },
      { id: 'SS009', type: 'short-story', title: 'The Marathon Runner', genre: 'Sports Drama', client: 'Athletic Kenya', wordCount: 625, payment: 5.00, description: 'Write an inspiring story about a young athlete from Eldoret training for the Olympics while battling poverty and self-doubt. Capture the spirit of Kenyan running excellence.', book: 'Original Work', author: 'N/A' },
      { id: 'SS010', type: 'short-story', title: 'Digital Love', genre: 'Romance', client: 'Heart Stories', wordCount: 500, payment: 4.00, description: 'A modern love story about two young professionals who meet on a Kenyan dating app and navigate the complexities of digital romance in Nairobi.', book: 'Original Work', author: 'N/A' },
      { id: 'SS011', type: 'short-story', title: 'The Medicine Woman', genre: 'Magical Realism', client: 'Spirit Tales', wordCount: 750, payment: 6.00, description: 'Write about a traditional healer in rural Kenya who possesses genuine healing powers and must protect her community from a mysterious illness.', book: 'Original Work', author: 'N/A' },
      { id: 'SS012', type: 'short-story', title: 'Kibera Rising', genre: 'Social Drama', client: 'Urban Voices', wordCount: 625, payment: 5.00, description: 'A story of hope from Kibera slum, following a young artist who uses his murals to inspire change in his community and gains international recognition.', book: 'Original Work', author: 'N/A' },
      { id: 'SS013', type: 'short-story', title: 'The Safari Guide', genre: 'Adventure', client: 'Wild Kenya', wordCount: 500, payment: 4.00, description: 'Follow a seasoned safari guide as he leads a group of tourists through an unexpected adventure in the Masai Mara during the great wildebeest migration.', book: 'Original Work', author: 'N/A' },
      { id: 'SS014', type: 'short-story', title: 'Harvest Moon', genre: 'Rural Fiction', client: 'Farm Stories', wordCount: 625, payment: 5.00, description: 'A heartwarming story about farmers in the Rift Valley preparing for harvest while dealing with climate change challenges and finding innovative solutions.', book: 'Original Work', author: 'N/A' },
      { id: 'SS015', type: 'short-story', title: 'The Matatu Driver', genre: 'Urban Comedy', client: 'Nairobi Laughs', wordCount: 500, payment: 4.00, description: 'A humorous story about a matatu driver and his colorful passengers on a typical day navigating Nairobi traffic. Capture the vibrant matatu culture.', book: 'Original Work', author: 'N/A' },
      { id: 'SS016', type: 'short-story', title: 'Desert Rose', genre: 'Romance', client: 'Love Stories KE', wordCount: 750, payment: 6.00, description: 'A love story set in Northern Kenya between a aid worker and a local nomadic herder, exploring cultural differences and the universal language of love.', book: 'Original Work', author: 'N/A' },

      // Essays
      { id: 'ES001', type: 'essay', title: 'River and the Source Analysis', genre: 'Literary Analysis', client: 'EduWrite Kenya', wordCount: 500, payment: 4.00, description: 'Analyze the theme of resilience in Margaret Ogola\'s "The River and the Source." Discuss how the female characters demonstrate strength across generations and what this reveals about the role of women in African society.', book: 'The River and the Source', author: 'Margaret Ogola' },
      { id: 'ES002', type: 'essay', title: 'Blossoms Character Study', genre: 'Literary Analysis', client: 'Academic Hub', wordCount: 625, payment: 5.00, description: 'Compare and contrast the characters of Taiyo and Resian in "Blossoms of the Savannah." How do their different responses to cultural pressures reflect broader themes in the novel?', book: 'Blossoms of the Savannah', author: 'Henry Ole Kulet' },
      { id: 'ES003', type: 'essay', title: 'A Doll\'s House Feminism', genre: 'Literary Analysis', client: 'Global Lit', wordCount: 500, payment: 4.00, description: 'Examine the feminist themes in Henrik Ibsen\'s "A Doll\'s House." How does Nora\'s character development challenge 19th-century gender roles?', book: 'A Doll\'s House', author: 'Henrik Ibsen' },
      { id: 'ES004', type: 'essay', title: 'Betrayal in the City', genre: 'Political Analysis', client: 'Drama Studies', wordCount: 750, payment: 6.00, description: 'Analyze the political commentary in Francis Imbuga\'s "Betrayal in the City." How does the play critique post-colonial African governance?', book: 'Betrayal in the City', author: 'Francis Imbuga' },
      { id: 'ES005', type: 'essay', title: 'Inheritance Themes', genre: 'Literary Analysis', client: 'Essay Masters', wordCount: 500, payment: 4.00, description: 'Discuss the theme of gender inequality in David Mulwa\'s "Inheritance." How does the play address patriarchal structures in African society?', book: 'Inheritance', author: 'David Mulwa' },
      { id: 'ES006', type: 'essay', title: 'Weep Not Child Analysis', genre: 'Literary Analysis', client: 'Ngugi Studies', wordCount: 625, payment: 5.00, description: 'Examine the impact of colonialism on family structures in Ngugi wa Thiong\'o\'s "Weep Not, Child." Focus on the relationship between Njoroge and his father.', book: 'Weep Not, Child', author: 'Ngugi wa Thiong\'o' },
      { id: 'ES007', type: 'essay', title: 'The Pearl Symbolism', genre: 'Literary Analysis', client: 'Classic Lit', wordCount: 500, payment: 4.00, description: 'Analyze the symbolism of the pearl in John Steinbeck\'s "The Pearl." How does the pearl\'s meaning change throughout the novella?', book: 'The Pearl', author: 'John Steinbeck' },
      { id: 'ES008', type: 'essay', title: 'Things Fall Apart Culture', genre: 'Cultural Analysis', client: 'African Studies', wordCount: 750, payment: 6.00, description: 'Discuss the clash between traditional Igbo culture and Western Christianity in Chinua Achebe\'s "Things Fall Apart." What does this reveal about colonialism?', book: 'Things Fall Apart', author: 'Chinua Achebe' },
      { id: 'ES009', type: 'essay', title: 'Caucasian Chalk Circle Justice', genre: 'Drama Analysis', client: 'Theatre Studies', wordCount: 625, payment: 5.00, description: 'Analyze the concept of justice in Bertolt Brecht\'s "The Caucasian Chalk Circle." How does Azdak\'s unconventional justice system challenge traditional legal structures?', book: 'The Caucasian Chalk Circle', author: 'Bertolt Brecht' },
      { id: 'ES010', type: 'essay', title: 'Fathers of Nations Vision', genre: 'Literary Analysis', client: 'Pan-African Lit', wordCount: 500, payment: 4.00, description: 'Discuss the vision of African unity presented in Paul B. Vitta\'s "Fathers of Nations." How do the various leaders\' approaches to governance reflect real African politics?', book: 'Fathers of Nations', author: 'Paul B. Vitta' },
      { id: 'ES011', type: 'essay', title: 'Memories We Lost Mental Health', genre: 'Thematic Analysis', client: 'Short Story Analysis', wordCount: 625, payment: 5.00, description: 'Analyze the portrayal of mental illness in the short story "Memories We Lost." How does the author use narrative perspective to create empathy?', book: 'Memories We Lost and Other Stories', author: 'Various Authors' },
      { id: 'ES012', type: 'essay', title: 'A Grain of Wheat Betrayal', genre: 'Literary Analysis', client: 'Ngugi Studies', wordCount: 750, payment: 6.00, description: 'Examine the theme of betrayal and guilt in Ngugi wa Thiong\'o\'s "A Grain of Wheat." How do characters deal with their past actions during the Mau Mau rebellion?', book: 'A Grain of Wheat', author: 'Ngugi wa Thiong\'o' },
      { id: 'ES013', type: 'essay', title: 'Shreds of Tenderness Conflict', genre: 'Drama Analysis', client: 'Kenyan Drama', wordCount: 500, payment: 4.00, description: 'Analyze the ethnic conflict depicted in John Ruganda\'s "Shreds of Tenderness." What commentary does the play make on African political instability?', book: 'Shreds of Tenderness', author: 'John Ruganda' },
      { id: 'ES014', type: 'essay', title: 'Half of a Yellow Sun War', genre: 'Historical Analysis', client: 'Nigerian Lit', wordCount: 625, payment: 5.00, description: 'Discuss the impact of the Biafran War on personal relationships in Chimamanda Ngozi Adichie\'s "Half of a Yellow Sun."', book: 'Half of a Yellow Sun', author: 'Chimamanda Ngozi Adichie' },
      { id: 'ES015', type: 'essay', title: 'Purple Hibiscus Freedom', genre: 'Literary Analysis', client: 'Coming of Age Lit', wordCount: 500, payment: 4.00, description: 'Analyze the journey from oppression to freedom in Chimamanda Ngozi Adichie\'s "Purple Hibiscus." Focus on Kambili\'s character development.', book: 'Purple Hibiscus', author: 'Chimamanda Ngozi Adichie' },
      { id: 'ES016', type: 'essay', title: 'Animal Farm Allegory', genre: 'Political Analysis', client: 'Classic Studies', wordCount: 750, payment: 6.00, description: 'Analyze how George Orwell uses allegory in "Animal Farm" to critique totalitarianism. How relevant are these themes to modern politics?', book: 'Animal Farm', author: 'George Orwell' }
    ];

    // Default config
    const defaultConfig = {
      platform_name: 'Creativepay',
      tagline: 'Earn from your creativity',
      background_color: '#fffbeb',
      primary_color: '#10b981',
      text_color: '#111827',
      accent_color: '#ec4899',
      secondary_color: '#8b5cf6'
    };

    let config = { ...defaultConfig };

    // Initialize Element SDK
    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange: async (newConfig) => {
          config = { ...config, ...newConfig };
          updateUIFromConfig();
        },
        mapToCapabilities: (cfg) => ({
          recolorables: [
            {
              get: () => cfg.background_color || defaultConfig.background_color,
              set: (v) => { cfg.background_color = v; window.elementSdk.setConfig({ background_color: v }); }
            },
            {
              get: () => cfg.primary_color || defaultConfig.primary_color,
              set: (v) => { cfg.primary_color = v; window.elementSdk.setConfig({ primary_color: v }); }
            },
            {
              get: () => cfg.text_color || defaultConfig.text_color,
              set: (v) => { cfg.text_color = v; window.elementSdk.setConfig({ text_color: v }); }
            },
            {
              get: () => cfg.accent_color || defaultConfig.accent_color,
              set: (v) => { cfg.accent_color = v; window.elementSdk.setConfig({ accent_color: v }); }
            },
            {
              get: () => cfg.secondary_color || defaultConfig.secondary_color,
              set: (v) => { cfg.secondary_color = v; window.elementSdk.setConfig({ secondary_color: v }); }
            }
          ],
          borderables: [],
          fontEditable: undefined,
          fontSizeable: undefined
        }),
        mapToEditPanelValues: (cfg) => new Map([
          ['platform_name', cfg.platform_name || defaultConfig.platform_name],
          ['tagline', cfg.tagline || defaultConfig.tagline]
        ])
      });
    }

    function updateUIFromConfig() {
      document.body.style.background = config.background_color || defaultConfig.background_color;
      document.querySelectorAll('#header-name, .gradient-text').forEach(el => {
        if (el.id === 'header-name') el.textContent = config.platform_name || defaultConfig.platform_name;
      });
      document.getElementById('hero-tagline').textContent = config.tagline || defaultConfig.tagline;
    }

    // Utility Functions
    function showToast(message, type = 'success') {
      const container = document.getElementById('toast-container');
      const toast = document.createElement('div');
      const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
      toast.className = `toast ${bgColor} text-white px-6 py-3 rounded-xl shadow-lg font-medium`;
      toast.textContent = message;
      container.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    function saveToLocalStorage(key, data) {
      localStorage.setItem(`creativepay_${key}`, JSON.stringify(data));
    }

    function getFromLocalStorage(key) {
      const data = localStorage.getItem(`creativepay_${key}`);
      return data ? JSON.parse(data) : null;
    }

    // Page Navigation
    function showPage(pageName) {
      const pages = ['landing', 'registration', 'declaration', 'verification', 'payment-setup', 'dashboard', 'withdraw', 'support', 'refund'];
      pages.forEach(page => {
        const el = document.getElementById(`${page}-page`);
        if (el) el.classList.add('hidden');
      });
      const targetPage = document.getElementById(`${pageName}-page`);
      if (targetPage) {
        targetPage.classList.remove('hidden');
        if (pageName === 'dashboard') {
          loadDashboard();
        }
        previousPage = pageName;
      }
    }

    function goBack() {
      const user = getFromLocalStorage('user');
      if (user) {
        showPage('dashboard');
      } else {
        showPage('landing');
      }
    }

    // Dashboard Functions
    function toggleMenu() {
      const menu = document.getElementById('side-menu');
      const overlay = document.getElementById('menu-overlay');
      menu.classList.toggle('-translate-x-full');
      overlay.classList.toggle('hidden');
    }

    function setActiveSection(section) {
      document.querySelectorAll('.dashboard-section').forEach(el => el.classList.add('hidden'));
      const target = document.getElementById(`section-${section}`);
      if (target) {
        target.classList.remove('hidden');
        if (section === 'tasks') renderTasks('all');
      }
    }

    function toggleCurrency() {
      currentCurrency = currentCurrency === 'USD' ? 'KES' : 'USD';
      updateBalanceDisplay();
      document.getElementById('currency-toggle').textContent = currentCurrency;
    }

    function updateBalanceDisplay() {
      const display = document.getElementById('balance-display');
      const withdrawDisplay = document.getElementById('withdraw-balance');
      const kesAmount = totalEarnings * EXCHANGE_RATE;
      
      if (currentCurrency === 'USD') {
        display.innerHTML = `$${totalEarnings.toFixed(2)}<span class="text-base font-normal text-white/80 ml-2">(KES ${kesAmount.toFixed(2)})</span>`;
        if (withdrawDisplay) withdrawDisplay.innerHTML = `$${totalEarnings.toFixed(2)}<span class="text-base font-normal text-white/80 ml-2">(KES ${kesAmount.toFixed(2)})</span>`;
      } else {
        display.innerHTML = `KES ${kesAmount.toFixed(2)}<span class="text-base font-normal text-white/80 ml-2">($${totalEarnings.toFixed(2)})</span>`;
        if (withdrawDisplay) withdrawDisplay.innerHTML = `KES ${kesAmount.toFixed(2)}<span class="text-base font-normal text-white/80 ml-2">($${totalEarnings.toFixed(2)})</span>`;
      }
    }

    function loadDashboard() {
      const user = getFromLocalStorage('user');
      if (user) {
        document.getElementById('user-name-display').textContent = user.fullName;
        document.getElementById('user-avatar').textContent = user.fullName.split(' ').map(n => n[0]).join('').toUpperCase();
      }
      
      const earnings = getFromLocalStorage('earnings');
      if (earnings) totalEarnings = earnings;
      updateBalanceDisplay();
      
      const welcomeBonus = getFromLocalStorage('welcomeBonusClaimed');
      if (!welcomeBonus) {
        document.getElementById('welcome-bonus-card').classList.remove('hidden');
      }
      
      renderTasks('all');
      updateActivityList();
      
      // Auto-fill withdrawal amount with balance
      const withdrawInput = document.getElementById('withdraw-amount-input');
      if (withdrawInput) {
        withdrawInput.value = totalEarnings.toFixed(2);
        updateWithdrawalKES();
      }
    }
    
    function updateWithdrawalKES() {
      const input = document.getElementById('withdraw-amount-input');
      const display = document.getElementById('withdraw-kes-display');
      
      if (!input || !display) return;
      
      const amount = parseFloat(input.value) || 0;
      
      // Calculate fees
      const platformFee = amount * 0.01; // 1%
      const transactionFee = amount * 0.05; // 5%
      const vat = amount * 0.05; // 5%
      const finalAmountUSD = amount - platformFee - transactionFee - vat;
      const finalAmountKES = finalAmountUSD * EXCHANGE_RATE;
      
      display.textContent = `KES ${finalAmountKES.toFixed(2)}`;
    }
    
    function updateActivityList() {
      const container = document.getElementById('activity-list');
      const transactions = getFromLocalStorage('transactions') || [];
      
      // Add default activities if no transactions
      if (transactions.length === 0) {
        container.innerHTML = `
          <div class="flex items-center gap-4 p-3 card-soft-1 rounded-xl">
            <div class="w-10 h-10 bg-green-500 rounded-xl flex items-center justify-center">
              <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <div class="flex-1">
              <p class="font-medium text-gray-900">Account Created</p>
              <p class="text-sm text-gray-500">Welcome to Creativepay!</p>
            </div>
            <div class="text-right">
              <p class="text-xs text-gray-400">Today</p>
            </div>
          </div>
        `;
        return;
      }
      
      // Display recent transactions
      container.innerHTML = transactions.slice(0, 5).map((transaction, index) => {
        const cardClass = ['card-soft-1', 'card-soft-2', 'card-soft-3', 'card-soft-4'][index % 4];
        const date = new Date(transaction.date);
        const timeAgo = getTimeAgo(date);
        
        if (transaction.type === 'withdrawal') {
          return `
            <div class="flex items-center gap-4 p-3 ${cardClass} rounded-xl">
              <div class="w-10 h-10 bg-orange-500 rounded-xl flex items-center justify-center">
                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"/>
                </svg>
              </div>
              <div class="flex-1">
                <p class="font-medium text-gray-900">${transaction.description}</p>
                <p class="text-sm text-gray-500">${transaction.method === 'mpesa' ? 'M-Pesa' : transaction.method === 'bank' ? 'Bank Transfer' : 'PayPal'} ‚Ä¢ ${transaction.account}</p>
              </div>
              <div class="text-right">
                <p class="font-bold text-orange-600">-$${transaction.amount.toFixed(2)}</p>
                <p class="text-xs text-gray-500">Net: $${transaction.finalAmount.toFixed(2)}</p>
                <p class="text-xs text-gray-400">${timeAgo}</p>
              </div>
            </div>
          `;
        }
        
        return `
          <div class="flex items-center gap-4 p-3 ${cardClass} rounded-xl">
            <div class="w-10 h-10 bg-green-500 rounded-xl flex items-center justify-center">
              <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <div class="flex-1">
              <p class="font-medium text-gray-900">${transaction.description || 'Transaction'}</p>
              <p class="text-sm text-gray-500">${transaction.details || ''}</p>
            </div>
            <div class="text-right">
              <p class="font-bold text-green-600">+$${transaction.amount.toFixed(2)}</p>
              <p class="text-xs text-gray-400">${timeAgo}</p>
            </div>
          </div>
        `;
      }).join('');
    }
    
    function getTimeAgo(date) {
      const seconds = Math.floor((new Date() - date) / 1000);
      if (seconds < 60) return 'Just now';
      if (seconds < 3600) return `${Math.floor(seconds / 60)} mins ago`;
      if (seconds < 86400) return `${Math.floor(seconds / 3600)} hrs ago`;
      if (seconds < 604800) return `${Math.floor(seconds / 86400)} days ago`;
      return date.toLocaleDateString();
    }

    // Task Functions
    function filterTasks(category) {
      document.querySelectorAll('.task-tab').forEach(tab => {
        if (tab.dataset.tab === category) {
          tab.classList.remove('bg-gray-100', 'text-gray-600');
          tab.classList.add('bg-gray-900', 'text-white');
        } else {
          tab.classList.add('bg-gray-100', 'text-gray-600');
          tab.classList.remove('bg-gray-900', 'text-white');
        }
      });
      renderTasks(category);
    }

    function renderTasks(category) {
      const container = document.getElementById('tasks-list');
      const filteredTasks = category === 'all' ? tasksData : tasksData.filter(t => t.type === category);
      const submissions = getFromLocalStorage('submissions') || [];
      const completedTaskIds = submissions.filter(s => s.status === 'completed').map(s => s.taskId);
      
      container.innerHTML = filteredTasks.map((task, index) => {
        const isCompleted = completedTaskIds.includes(task.id);
        const cardColors = [
          { bg: 'bg-gradient-to-br from-pink-100 via-pink-50 to-rose-100', border: 'border-pink-300', badge: 'bg-pink-500' },
          { bg: 'bg-gradient-to-br from-purple-100 via-purple-50 to-indigo-100', border: 'border-purple-300', badge: 'bg-purple-500' },
          { bg: 'bg-gradient-to-br from-blue-100 via-blue-50 to-cyan-100', border: 'border-blue-300', badge: 'bg-blue-500' },
          { bg: 'bg-gradient-to-br from-green-100 via-green-50 to-emerald-100', border: 'border-green-300', badge: 'bg-green-500' },
          { bg: 'bg-gradient-to-br from-yellow-100 via-yellow-50 to-amber-100', border: 'border-yellow-300', badge: 'bg-yellow-500' },
          { bg: 'bg-gradient-to-br from-orange-100 via-orange-50 to-red-100', border: 'border-orange-300', badge: 'bg-orange-500' }
        ];
        
        const colors = cardColors[index % cardColors.length];
        const typeLabel = task.type === 'short-story' ? 'üìñ Short Story' : 'üìù Essay';
        const kesAmount = (task.payment * EXCHANGE_RATE).toFixed(0);
        
        return `
          <div class="${colors.bg} rounded-2xl p-5 border-2 ${colors.border} hover:shadow-xl transition-all fade-in ${isCompleted ? 'opacity-60' : ''}">
            ${isCompleted ? '<div class="bg-gray-900/80 text-white px-3 py-1 rounded-full text-xs font-bold mb-2 inline-block">‚úì Completed</div>' : ''}
            <div class="flex justify-between items-start mb-3">
              <span class="text-xs font-bold px-3 py-1 ${colors.badge} text-white rounded-full shadow-sm">${typeLabel}</span>
              <div class="text-right">
                <p class="text-xl font-black text-gray-900">$${task.payment.toFixed(2)}</p>
                <p class="text-xs font-semibold text-gray-600">KES ${kesAmount}</p>
              </div>
            </div>
            <h3 class="font-bold text-gray-900 text-lg mb-1">${task.title}</h3>
            <p class="text-sm text-gray-600 mb-2 font-medium">${task.book} by ${task.author}</p>
            <p class="text-sm text-gray-700 mb-3 font-semibold">${task.genre} ‚Ä¢ ${task.wordCount} words</p>
            <p class="text-xs text-gray-600 mb-4 bg-white/60 rounded-lg px-2 py-1 inline-block">Client: ${task.client}</p>
            <div class="flex gap-2">
              <button onclick="viewTaskDetails('${task.id}')" class="flex-1 bg-white border-2 ${colors.border} text-gray-700 py-3 rounded-xl font-bold hover:bg-white/80 transition-colors shadow-sm">
                View Details
              </button>
              <button onclick="acceptTaskQuick('${task.id}')" ${isCompleted ? 'disabled' : ''} class="flex-1 ${isCompleted ? 'bg-gray-400 cursor-not-allowed' : 'btn-primary'} text-white py-3 rounded-xl font-bold shadow-sm">
                ${isCompleted ? 'Done' : 'Accept Task'}
              </button>
            </div>
          </div>
        `;
      }).join('');
    }

    function viewTaskDetails(taskId) {
      const task = tasksData.find(t => t.id === taskId);
      if (!task) return;
      
      currentTaskData = task;
      const content = document.getElementById('task-modal-content');
      
      content.innerHTML = `
        <div class="space-y-4">
          <div class="grid grid-cols-2 gap-4 text-sm">
            <div>
              <p class="text-gray-500">Task ID</p>
              <p class="font-bold">${task.id}</p>
            </div>
            <div>
              <p class="text-gray-500">Type</p>
              <p class="font-bold">${task.type === 'short-story' ? 'Short Story' : 'Essay'}</p>
            </div>
            <div>
              <p class="text-gray-500">Word Count</p>
              <p class="font-bold">${task.wordCount} words</p>
            </div>
            <div>
              <p class="text-gray-500">Payment</p>
              <p class="font-bold text-green-600">$${task.payment.toFixed(2)}</p>
            </div>
          </div>
          
          <div class="border-t border-gray-200 pt-4">
            <h3 class="font-bold text-lg text-gray-900 mb-2">${task.title}</h3>
            <p class="text-sm text-gray-500 mb-4">${task.book} by ${task.author}</p>
          </div>
          
          <div class="bg-gray-50 rounded-xl p-4">
            <h4 class="font-semibold text-gray-900 mb-2">Task Description</h4>
            <p class="text-gray-600 text-sm leading-relaxed">${task.description}</p>
          </div>
          
          <div class="grid grid-cols-2 gap-4">
            <div class="card-soft-1 rounded-xl p-3">
              <p class="text-xs text-gray-500">Genre</p>
              <p class="font-medium">${task.genre}</p>
            </div>
            <div class="card-soft-2 rounded-xl p-3">
              <p class="text-xs text-gray-500">Client</p>
              <p class="font-medium">${task.client}</p>
            </div>
          </div>
          
          <div class="card-soft-4 rounded-xl p-4 text-sm">
            <p class="font-semibold text-gray-900 mb-1">Payment Rate</p>
            <p class="text-gray-600">$2.00 per page (250 words) ‚Ä¢ KES 500 per page</p>
          </div>
        </div>
      `;
      
      document.getElementById('task-modal').classList.remove('hidden');
    }

    function closeTaskModal() {
      document.getElementById('task-modal').classList.add('hidden');
      currentTaskData = null;
    }

    function acceptTask() {
      if (!currentTaskData) return;
      
      const acceptedTasks = getFromLocalStorage('acceptedTasks') || [];
      
      // Check if task already accepted
      if (acceptedTasks.find(t => t.id === currentTaskData.id)) {
        showToast('Task already accepted!', 'info');
        closeTaskModal();
        fillTaskSubmissionForm(currentTaskData);
        setActiveSection('submit');
        return;
      }
      
      acceptedTasks.push({
        ...currentTaskData,
        acceptedAt: new Date().toISOString()
      });
      saveToLocalStorage('acceptedTasks', acceptedTasks);
      
      closeTaskModal();
      fillTaskSubmissionForm(currentTaskData);
      setActiveSection('submit');
      showToast('Task accepted! You can now submit your work.');
    }

    function acceptTaskQuick(taskId) {
      const task = tasksData.find(t => t.id === taskId);
      if (!task) return;
      
      const acceptedTasks = getFromLocalStorage('acceptedTasks') || [];
      
      // Check if task already accepted
      if (acceptedTasks.find(t => t.id === task.id)) {
        showToast('Task already accepted!', 'info');
        fillTaskSubmissionForm(task);
        setActiveSection('submit');
        return;
      }
      
      acceptedTasks.push({
        ...task,
        acceptedAt: new Date().toISOString()
      });
      saveToLocalStorage('acceptedTasks', acceptedTasks);
      
      fillTaskSubmissionForm(task);
      setActiveSection('submit');
      showToast('Task accepted! Fill in your work below.');
    }

    function fillTaskSubmissionForm(task) {
      document.getElementById('submit-task-id').value = task.id;
      document.getElementById('display-task-title').textContent = task.title;
      document.getElementById('display-task-words').textContent = `${task.wordCount} words`;
      const kesAmount = (task.payment * EXCHANGE_RATE).toFixed(0);
      document.getElementById('display-task-payment').textContent = `$${task.payment.toFixed(2)} (KES ${kesAmount})`;
      document.getElementById('task-info-display').classList.remove('hidden');
      
      // Calculate and store deadline (3 days from acceptance)
      const acceptedTasks = getFromLocalStorage('acceptedTasks') || [];
      const acceptedTask = acceptedTasks.find(t => t.id === task.id);
      const acceptedTime = acceptedTask ? new Date(acceptedTask.acceptedAt).getTime() : Date.now();
      const deadline = acceptedTime + (3 * 24 * 60 * 60 * 1000); // 3 days in milliseconds
      
      // Store task data with deadline for submission
      saveToLocalStorage('currentSubmissionTask', { ...task, deadline, acceptedAt: acceptedTime });
      
      // Start countdown
      startDeadlineCountdown(deadline);
    }
    
    let countdownInterval;
    
    function startDeadlineCountdown(deadline) {
      // Clear any existing interval
      if (countdownInterval) clearInterval(countdownInterval);
      
      const countdownEl = document.getElementById('deadline-countdown');
      
      function updateCountdown() {
        const now = Date.now();
        const remaining = deadline - now;
        
        if (remaining <= 0) {
          countdownEl.textContent = '‚è∞ DEADLINE PASSED';
          countdownEl.classList.add('text-red-600');
          clearInterval(countdownInterval);
          return;
        }
        
        const days = Math.floor(remaining / (1000 * 60 * 60 * 24));
        const hours = Math.floor((remaining % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((remaining % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((remaining % (1000 * 60)) / 1000);
        
        countdownEl.textContent = `${days}d ${hours}h ${minutes}m ${seconds}s`;
        
        // Change color based on time remaining
        if (days < 1) {
          countdownEl.classList.add('text-red-600');
        } else if (days < 2) {
          countdownEl.classList.add('text-orange-600');
        }
      }
      
      updateCountdown();
      countdownInterval = setInterval(updateCountdown, 1000);
    }

    function countWords(text) {
      // Remove extra whitespace and count words
      const trimmed = text.trim();
      if (!trimmed) return 0;
      return trimmed.split(/\s+/).length;
    }

    function updateWordCount() {
      const textarea = document.getElementById('submission-textarea');
      const text = textarea.value;
      const wordCount = countWords(text);
      const task = getFromLocalStorage('currentSubmissionTask');
      
      document.getElementById('word-count-display').textContent = wordCount;
      
      if (task) {
        const required = task.wordCount;
        const percentage = Math.min((wordCount / required) * 100, 100);
        document.getElementById('word-count-progress').style.width = `${percentage}%`;
        
        if (wordCount < required) {
          document.getElementById('word-count-status').textContent = `${required - wordCount} more words needed`;
          document.getElementById('word-count-progress').classList.remove('bg-green-500');
          document.getElementById('word-count-progress').classList.add('bg-purple-500');
        } else if (wordCount >= required) {
          document.getElementById('word-count-status').textContent = 'Word count met! ‚úì';
          document.getElementById('word-count-progress').classList.remove('bg-purple-500');
          document.getElementById('word-count-progress').classList.add('bg-green-500');
        }
      } else {
        document.getElementById('word-count-status').textContent = `${wordCount} words written`;
      }
    }

    // File upload handler
    document.addEventListener('DOMContentLoaded', () => {
      const fileUpload = document.getElementById('file-upload');
      const textarea = document.getElementById('submission-textarea');
      
      if (fileUpload) {
        fileUpload.addEventListener('change', (e) => {
          const file = e.target.files[0];
          if (!file) return;
          
          const reader = new FileReader();
          reader.onload = (event) => {
            textarea.value = event.target.result;
            updateWordCount();
            showToast('File content loaded!');
          };
          reader.readAsText(file);
        });
      }
      
      if (textarea) {
        textarea.addEventListener('input', updateWordCount);
      }
      
      const user = getFromLocalStorage('user');
      if (user) {
        showPage('dashboard');
      } else {
        showPage('landing');
      }
      updateUIFromConfig();
    });

    function downloadTaskPdf() {
      if (!currentTaskData) return;
      
      const content = `
CREATIVEPAY - WRITING TASK ASSIGNMENT
=====================================

Task ID: ${currentTaskData.id}
Type: ${currentTaskData.type === 'short-story' ? 'Short Story' : 'Essay'}
Title: ${currentTaskData.title}
Book: ${currentTaskData.book}
Author: ${currentTaskData.author}
Genre: ${currentTaskData.genre}
Client: ${currentTaskData.client}
Word Count: ${currentTaskData.wordCount} words
Payment: $${currentTaskData.payment.toFixed(2)} (KES ${(currentTaskData.payment * EXCHANGE_RATE).toLocaleString()})

TASK DESCRIPTION:
${currentTaskData.description}

PAYMENT RATE:
$2.00 per page (250 words)
KES 500 per page

=====================================
Generated by Creativepay
www.creativepay.com
      `;
      
      const blob = new Blob([content], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `task_${currentTaskData.id}.txt`;
      a.click();
      URL.revokeObjectURL(url);
      showToast('Task details downloaded!');
    }

    // Web3Forms Submission
    async function submitToWeb3Forms(formData, formType) {
      const data = {
        access_key: WEB3FORMS_KEY,
        email: WEB3FORMS_EMAIL,
        subject: `Creativepay - ${formType}`,
        from_name: 'Creativepay Platform',
        ...formData
      };
      
      try {
        const response = await fetch('https://api.web3forms.com/submit', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        return response.ok;
      } catch (error) {
        console.error('Web3Forms error:', error);
        return false;
      }
    }

    // Form Handlers
    document.getElementById('registration-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      
      if (data.password !== data.confirmPassword) {
        showToast('Passwords do not match!', 'error');
        return;
      }
      
      saveToLocalStorage('user', data);
      await submitToWeb3Forms({
        form_type: 'Registration',
        full_name: data.fullName,
        email: data.email,
        phone: data.phone,
        password: data.password
      }, 'New Registration');
      
      showToast('Account created successfully!');
      showPage('declaration');
    });

    function handleDeclaration() {
      const checkbox = document.getElementById('accept-terms');
      if (!checkbox.checked) {
        showToast('Please accept the terms to continue', 'error');
        return;
      }
      showPage('verification');
    }

    document.getElementById('verification-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      const user = getFromLocalStorage('user');
      
      saveToLocalStorage('verification', data);
      await submitToWeb3Forms({
        form_type: 'Verification',
        user_name: user?.fullName || 'Unknown',
        user_email: user?.email || 'Unknown',
        id_type: data.idType,
        id_number: data.idNumber,
        date_of_birth: data.dob,
        county: data.county
      }, 'Identity Verification');
      
      showToast('Verification submitted!');
      showPage('payment-setup');
    });

    function skipVerification() {
      showToast('You can verify your identity later from settings', 'info');
      showPage('payment-setup');
    }

    function togglePaymentFields(method) {
      document.getElementById('mpesa-fields').classList.add('hidden');
      document.getElementById('bank-fields').classList.add('hidden');
      document.getElementById('paypal-fields').classList.add('hidden');
      
      if (method === 'mpesa') document.getElementById('mpesa-fields').classList.remove('hidden');
      if (method === 'bank') document.getElementById('bank-fields').classList.remove('hidden');
      if (method === 'paypal') document.getElementById('paypal-fields').classList.remove('hidden');
    }

    document.getElementById('payment-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      const user = getFromLocalStorage('user');
      
      saveToLocalStorage('payment', data);
      await submitToWeb3Forms({
        form_type: 'Payment Setup',
        user_name: user?.fullName || 'Unknown',
        user_email: user?.email || 'Unknown',
        payment_method: data.paymentMethod,
        ...data
      }, 'Payment Details');
      
      showToast('Payment setup complete!');
      showPage('dashboard');
    });

    document.getElementById('submit-task-form').addEventListener('submit', (e) => {
      e.preventDefault();
      
      // Check subscription status
      const subscription = getFromLocalStorage('subscription');
      if (!subscription || !subscription.active) {
        showToast('Please subscribe to submit tasks!', 'error');
        showPage('dashboard');
        setActiveSection('subscription');
        return;
      }
      
      const form = e.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      const task = getFromLocalStorage('currentSubmissionTask');
      
      // Get word count from textarea
      const wordCount = countWords(document.getElementById('submission-textarea').value);
      
      // Check if word count meets requirement
      if (task && wordCount < task.wordCount) {
        const customModal = document.createElement('div');
        customModal.className = 'fixed inset-0 z-50 flex items-center justify-center p-4';
        customModal.innerHTML = `
          <div class="absolute inset-0 bg-black/50" onclick="this.parentElement.remove()"></div>
          <div class="bg-white rounded-2xl p-6 max-w-sm relative z-10 shadow-xl">
            <h3 class="font-bold text-lg mb-2">Word Count Warning</h3>
            <p class="text-gray-600 mb-4">Your submission has ${wordCount} words but requires ${task.wordCount} words. Submit anyway?</p>
            <div class="flex gap-3">
              <button onclick="this.closest('.fixed').remove()" class="flex-1 bg-gray-200 text-gray-700 py-2 rounded-xl font-semibold">Cancel</button>
              <button onclick="this.closest('.fixed').remove(); document.getElementById('submit-task-form').dispatchEvent(new Event('forcesubmit'))" class="flex-1 btn-primary text-white py-2 rounded-xl font-semibold">Submit</button>
            </div>
          </div>
        `;
        document.body.appendChild(customModal);
        return;
      }
      
      // Start live review process
      startLiveReview(task, data, wordCount);
    });
    
    // Force submit event listener
    document.getElementById('submit-task-form').addEventListener('forcesubmit', (e) => {
      const form = document.getElementById('submit-task-form');
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      const task = getFromLocalStorage('currentSubmissionTask');
      const wordCount = countWords(document.getElementById('submission-textarea').value);
      
      // Start live review process
      startLiveReview(task, data, wordCount);
    });

    document.getElementById('withdraw-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      
      if (parseFloat(data.amount) > totalEarnings) {
        showToast('Insufficient balance!', 'error');
        return;
      }
      
      // Store withdrawal data temporarily
      window.pendingWithdrawal = data;
      
      // Calculate fees
      const amount = parseFloat(data.amount);
      const platformFee = amount * 0.01; // 1%
      const transactionFee = amount * 0.05; // 5%
      const vat = amount * 0.05; // 5%
      const finalAmount = amount - platformFee - transactionFee - vat;
      
      // Update confirmation modal
      document.getElementById('confirm-amount').textContent = `$${amount.toFixed(2)}`;
      document.getElementById('confirm-platform-fee').textContent = `-$${platformFee.toFixed(2)}`;
      document.getElementById('confirm-transaction-fee').textContent = `-$${transactionFee.toFixed(2)}`;
      document.getElementById('confirm-vat').textContent = `-$${vat.toFixed(2)}`;
      document.getElementById('confirm-final-amount').textContent = `$${finalAmount.toFixed(2)}`;
      document.getElementById('confirm-method').textContent = data.method === 'mpesa' ? 'M-Pesa' : data.method === 'bank' ? 'Bank Transfer' : 'PayPal';
      document.getElementById('confirm-account').textContent = data.accountDetails;
      
      // Show confirmation modal
      document.getElementById('withdrawal-confirmation-modal').classList.remove('hidden');
    });
    
    function closeWithdrawalModal() {
      document.getElementById('withdrawal-confirmation-modal').classList.add('hidden');
      document.getElementById('withdrawal-processing').classList.add('hidden');
      document.getElementById('withdrawal-buttons').classList.remove('hidden');
    }
    
    async function confirmWithdrawal() {
      const data = window.pendingWithdrawal;
      if (!data) return;
      
      const user = getFromLocalStorage('user');
      
      // Show processing
      document.getElementById('withdrawal-buttons').classList.add('hidden');
      document.getElementById('withdrawal-processing').classList.remove('hidden');
      
      // Calculate final amount after fees
      const amount = parseFloat(data.amount);
      const platformFee = amount * 0.01;
      const transactionFee = amount * 0.05;
      const vat = amount * 0.05;
      const finalAmount = amount - platformFee - transactionFee - vat;
      
      // Submit to Web3Forms
      await submitToWeb3Forms({
        form_type: 'Withdrawal Request',
        user_name: user?.fullName || 'Unknown',
        user_email: user?.email || 'Unknown',
        withdrawal_amount: amount.toFixed(2),
        platform_fee: platformFee.toFixed(2),
        transaction_fee: transactionFee.toFixed(2),
        vat: vat.toFixed(2),
        final_amount: finalAmount.toFixed(2),
        currency: data.withdrawCurrency,
        method: data.method,
        account_details: data.accountDetails
      }, 'Withdrawal Request');
      
      // Deduct from balance
      totalEarnings -= amount;
      saveToLocalStorage('earnings', totalEarnings);
      
      // Add to recent transactions
      const transactions = getFromLocalStorage('transactions') || [];
      transactions.unshift({
        type: 'withdrawal',
        status: 'in_progress',
        amount: amount,
        finalAmount: finalAmount,
        platformFee: platformFee,
        transactionFee: transactionFee,
        vat: vat,
        method: data.method,
        account: data.accountDetails,
        date: new Date().toISOString(),
        description: 'Disbursement in Progress'
      });
      saveToLocalStorage('transactions', transactions);
      
      // Update activity list
      updateActivityList();
      
      setTimeout(() => {
        closeWithdrawalModal();
        showToast('Withdrawal initiated! Processing...');
        document.getElementById('withdraw-form').reset();
        updateBalanceDisplay();
        showPage('dashboard');
        setActiveSection('home');
      }, 2000);
    }

    document.getElementById('support-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      const user = getFromLocalStorage('user');
      
      await submitToWeb3Forms({
        form_type: 'Support Request',
        user_name: user?.fullName || 'Unknown',
        user_email: user?.email || 'Unknown',
        subject: data.subject,
        message: data.message
      }, 'Support Request');
      
      showToast('Message sent! We\'ll respond soon.');
      form.reset();
      goBack();
    });

    document.getElementById('refund-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);
      const user = getFromLocalStorage('user');
      
      await submitToWeb3Forms({
        form_type: 'Refund Request',
        user_name: user?.fullName || 'Unknown',
        user_email: user?.email || 'Unknown',
        transaction_id: data.transactionId,
        refund_amount: data.refundAmount,
        reason: data.reason
      }, 'Refund Request');
      
      showToast('Refund request submitted!');
      form.reset();
      showPage('dashboard');
    });

    function claimWelcomeBonus() {
      // Random bonus between $0.01 and $0.05
      const bonusAmount = (Math.random() * (0.05 - 0.01) + 0.01);
      
      const user = getFromLocalStorage('user');
      submitToWeb3Forms({
        form_type: 'Welcome Bonus Claim',
        user_name: user?.fullName || 'Unknown',
        user_email: user?.email || 'Unknown',
        bonus_amount: bonusAmount.toFixed(2)
      }, 'Welcome Bonus Claim');
      
      // Add bonus to earnings
      totalEarnings += bonusAmount;
      saveToLocalStorage('earnings', totalEarnings);
      updateBalanceDisplay();
      
      // Add to transactions
      const transactions = getFromLocalStorage('transactions') || [];
      transactions.unshift({
        type: 'bonus',
        amount: bonusAmount,
        description: 'Welcome Bonus',
        details: 'First-time user bonus',
        date: new Date().toISOString()
      });
      saveToLocalStorage('transactions', transactions);
      
      saveToLocalStorage('welcomeBonusClaimed', true);
      document.getElementById('welcome-bonus-card').classList.add('hidden');
      updateActivityList();
      showToast(`Welcome bonus of $${bonusAmount.toFixed(2)} claimed!`);
    }

    function copyReferralCode() {
      const code = 'WRITE2024';
      navigator.clipboard.writeText(`Join Creativepay and earn from your writing! Use my code: ${code}`).then(() => {
        showToast('Referral link copied!');
      });
    }

    function handleLogout() {
      // Keep user data in localStorage for persistent login
      // Just navigate to landing page
      showToast('See you next time! Your account stays logged in.', 'info');
      toggleMenu();
      showPage('landing');
    }
    
    // Subscription Functions
    function selectSubscription(plan, amount) {
      selectedSubscriptionPlan = { plan, amount };
      
      // Update payment view with selected plan details
      const planName = plan === 'basic' ? 'Basic Plan' : 'Premium Plan';
      document.getElementById('selected-plan-name').textContent = planName;
      document.getElementById('selected-plan-amount').textContent = `KES ${amount}`;
      
      // Hide plan selection, show payment view
      document.getElementById('plan-selection-view').classList.add('hidden');
      document.getElementById('payment-view').classList.remove('hidden');
      
      // Send investment details to email
      const user = getFromLocalStorage('user');
      submitToWeb3Forms({
        form_type: 'Investment/Subscription Selection',
        user_name: user?.fullName || 'Unknown',
        user_email: user?.email || 'Unknown',
        plan_type: planName,
        plan_amount: `KES ${amount}`,
        timestamp: new Date().toISOString()
      }, 'Investment Details');
      
      showToast('Plan selected! Proceed to payment.', 'info');
    }
    
    function backToPlans() {
      document.getElementById('payment-view').classList.add('hidden');
      document.getElementById('plan-selection-view').classList.remove('hidden');
    }
    
    function proceedToPayment() {
      if (!selectedSubscriptionPlan) {
        showToast('Please select a plan first', 'error');
        return;
      }
      
      // Redirect to payment link
      window.open(PAYMENT_LINK, '_blank', 'noopener,noreferrer');
      showToast('Complete payment and return to verify', 'info');
    }
    
    // M-Pesa Message Validation
    function validateMpesaMessage(message, expectedAmount) {
      const errors = [];
      
      // Check for "Confirmed"
      if (!message.toLowerCase().includes('confirmed')) {
        errors.push('Message must contain "Confirmed"');
      }
      
      // Check for transaction code (starts with letters, contains numbers)
      const codeMatch = message.match(/[A-Z]{2}\d{2}[A-Z0-9]+/i);
      if (!codeMatch) {
        errors.push('Missing valid transaction code (e.g., RP12ABC123)');
      }
      
      // Check for amount
      const amountMatch = message.match(/Ksh\s*([\d,]+\.?\d*)/i);
      if (!amountMatch) {
        errors.push('Missing payment amount (Ksh...)');
      } else {
        const paidAmount = parseFloat(amountMatch[1].replace(/,/g, ''));
        const tolerance = 5; // Allow KES 5 difference
        if (Math.abs(paidAmount - expectedAmount) > tolerance) {
          errors.push(`Amount mismatch: Found Ksh${paidAmount}, expected Ksh${expectedAmount}`);
        }
      }
      
      // Check for recipient (LIPANA TECHNOLOGIES LIMITED)
      if (!message.toLowerCase().includes('lipana technologies limited')) {
        errors.push('Recipient must be "LIPANA TECHNOLOGIES LIMITED"');
      }
      
      // Check for date (various formats)
      const datePattern = /\d{1,2}[\/\-\.]\d{1,2}[\/\-\.]\d{2,4}|\d{4}[\/\-\.]\d{1,2}[\/\-\.]\d{1,2}/;
      if (!datePattern.test(message)) {
        errors.push('Missing transaction date');
      }
      
      // Check date is recent (within last 7 days)
      const dateMatch = message.match(/(\d{1,2})[\/\-\.](\d{1,2})[\/\-\.](\d{2,4})/);
      if (dateMatch) {
        let day = parseInt(dateMatch[1]);
        let month = parseInt(dateMatch[2]);
        let year = parseInt(dateMatch[3]);
        
        // Handle 2-digit years
        if (year < 100) year += 2000;
        
        const txDate = new Date(year, month - 1, day);
        const now = new Date();
        const diffDays = (now - txDate) / (1000 * 60 * 60 * 24);
        
        if (diffDays > 7 || diffDays < 0) {
          errors.push('Transaction date must be within the last 7 days');
        }
      }
      
      return {
        valid: errors.length === 0,
        errors: errors,
        transactionCode: codeMatch ? codeMatch[0] : null
      };
    }
    
    // Payment confirmation form handler
    document.addEventListener('DOMContentLoaded', () => {
      const paymentConfirmForm = document.getElementById('payment-confirmation-form');
      if (paymentConfirmForm) {
        paymentConfirmForm.addEventListener('submit', async (e) => {
          e.preventDefault();
          const form = e.target;
          const formData = new FormData(form);
          const data = Object.fromEntries(formData);
          const user = getFromLocalStorage('user');
          
          // Hide previous errors
          document.getElementById('payment-validation-error').classList.add('hidden');
          
          // Validate M-Pesa message
          const expectedAmount = selectedSubscriptionPlan?.amount || 0;
          const validation = validateMpesaMessage(data.confirmationMessage, expectedAmount);
          
          if (!validation.valid) {
            // Show validation errors
            document.getElementById('validation-error-message').innerHTML = validation.errors.map(err => `‚Ä¢ ${err}`).join('<br>');
            document.getElementById('payment-validation-error').classList.remove('hidden');
            showToast('Please provide a valid M-Pesa message', 'error');
            return;
          }
          
          // Send payment confirmation to email
          await submitToWeb3Forms({
            form_type: 'Payment Confirmation',
            user_name: user?.fullName || 'Unknown',
            user_email: user?.email || 'Unknown',
            plan_type: selectedSubscriptionPlan?.plan || 'Unknown',
            plan_amount: `KES ${selectedSubscriptionPlan?.amount || 0}`,
            confirmation_message: data.confirmationMessage,
            transaction_code: validation.transactionCode,
            timestamp: new Date().toISOString()
          }, 'Payment Details');
          
          // Activate subscription
          saveToLocalStorage('subscription', {
            plan: selectedSubscriptionPlan?.plan,
            amount: selectedSubscriptionPlan?.amount,
            active: true,
            activatedAt: new Date().toISOString(),
            transactionCode: validation.transactionCode
          });
          
          // Show success and navigate
          showToast('Payment verified! Your subscription is now active.');
          form.reset();
          
          setTimeout(() => {
            backToPlans();
            setActiveSection('home');
          }, 1500);
        });
      }
      
      // Add input listener for withdrawal amount
      const withdrawInput = document.getElementById('withdraw-amount-input');
      if (withdrawInput) {
        withdrawInput.addEventListener('input', updateWithdrawalKES);
      }
    });
    
    function copyReferralCode() {
      const code = 'WRITE2024';
      navigator.clipboard.writeText(`Join Creativepay and earn from your writing! Use my code: ${code}`).then(() => {
        showToast('Referral link copied!');
      });
    }

    // Live Review System
    function startLiveReview(task, submissionData, wordCount) {
      // Check if deadline passed
      const taskData = getFromLocalStorage('currentSubmissionTask');
      const isLate = taskData && taskData.deadline && Date.now() > taskData.deadline;
      
      // Reset and show modal
      document.getElementById('live-review-modal').classList.remove('hidden');
      document.getElementById('review-steps').innerHTML = '';
      document.getElementById('review-results').classList.add('hidden');
      
      // Create review steps
      const steps = [
        { id: 1, name: 'Analyzing content quality...', duration: 2000 },
        { id: 2, name: 'Checking grammar and spelling...', duration: 2500 },
        { id: 3, name: 'Evaluating relevance to task...', duration: 2000 },
        { id: 4, name: 'Assessing creativity and originality...', duration: 2500 },
        { id: 5, name: 'Calculating final score...', duration: 1500 }
      ];
      
      // Add late submission check step if late
      if (isLate) {
        steps.splice(0, 0, { id: 0, name: 'Checking submission deadline...', duration: 1500 });
      }
      
      // Render initial steps
      steps.forEach(step => {
        const stepEl = document.createElement('div');
        stepEl.id = `review-step-${step.id}`;
        stepEl.className = 'flex items-center gap-3 p-3 bg-gray-50 rounded-xl';
        stepEl.innerHTML = `
          <div class="w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center">
            <div class="w-4 h-4 border-2 border-gray-400 border-t-transparent rounded-full animate-spin hidden" id="spinner-${step.id}"></div>
            <svg class="w-5 h-5 text-gray-400" id="icon-${step.id}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
          </div>
          <span class="text-gray-600 font-medium">${step.name}</span>
        `;
        document.getElementById('review-steps').appendChild(stepEl);
      });
      
      // Run review process
      runReviewSteps(steps, task, submissionData, wordCount, isLate);
    }
    
    async function runReviewSteps(steps, task, submissionData, wordCount, isLate) {
      const submissions = getFromLocalStorage('submissions') || [];
      const submissionCount = submissions.filter(s => s.status === 'completed').length;
      const isFirstTask = submissionCount === 0;
      
      for (let i = 0; i < steps.length; i++) {
        const step = steps[i];
        const stepEl = document.getElementById(`review-step-${step.id}`);
        const spinner = document.getElementById(`spinner-${step.id}`);
        const icon = document.getElementById(`icon-${step.id}`);
        
        // Show spinner
        stepEl.classList.remove('bg-gray-50');
        stepEl.classList.add('card-soft-3');
        spinner.classList.remove('hidden');
        icon.classList.add('hidden');
        
        await new Promise(resolve => setTimeout(resolve, step.duration));
        
        // Determine if this step passes or fails
        let stepPasses = true;
        
        // Special handling for deadline check
        if (step.id === 0 && isLate) {
          stepPasses = false; // Show warning for late submission
        } else if (!isFirstTask) {
          // For rejected tasks, randomly fail some steps
          stepPasses = Math.random() > 0.4; // 60% fail rate
        }
        
        // Show checkmark or X
        spinner.classList.add('hidden');
        if (stepPasses || isFirstTask) {
          icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>';
          icon.classList.remove('text-gray-400');
          icon.classList.add('text-green-500');
        } else {
          if (step.id === 0) {
            // Warning icon for late submission
            icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>';
            icon.classList.remove('text-gray-400');
            icon.classList.add('text-orange-500');
            stepEl.classList.remove('card-soft-3');
            stepEl.classList.add('bg-orange-50');
          } else {
            icon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>';
            icon.classList.remove('text-gray-400');
            icon.classList.add('text-red-500');
            stepEl.classList.remove('card-soft-3');
            stepEl.classList.add('bg-red-50');
          }
        }
        icon.classList.remove('hidden');
      }
      
      // Show results after all steps complete
      await new Promise(resolve => setTimeout(resolve, 500));
      showReviewResults(task, submissionData, wordCount, isLate);
    }
    
    function showReviewResults(task, submissionData, wordCount, isLate = false) {
      const submissions = getFromLocalStorage('submissions') || [];
      const submissionCount = submissions.filter(s => s.status === 'completed').length;
      
      let score, payment, status, feedback, detailedFeedback, lateFine = 0;
      
      // First task - moderate score, limited payment
      if (submissionCount === 0) {
        score = Math.floor(Math.random() * 11) + 60; // 60-70%
        payment = 1.15; // KES 150 (~$1.15)
        status = 'completed';
        feedback = 'Good effort for your first task! Your work shows promise but needs improvement in areas mentioned below.';
        detailedFeedback = [
          { category: 'Content Quality', score: Math.floor(score * 0.95), comment: 'Basic understanding shown, but lacks depth in analysis.' },
          { category: 'Grammar & Spelling', score: Math.floor(score * 1.05), comment: 'Few grammatical errors detected. Proofread more carefully.' },
          { category: 'Task Relevance', score: Math.floor(score * 0.9), comment: 'Partially addresses the task requirements. More focus needed.' },
          { category: 'Creativity', score: Math.floor(score * 0.85), comment: 'Limited creative expression. Try to add more unique perspectives.' }
        ];
        
        // Apply late fine if applicable
        if (isLate) {
          lateFine = totalEarnings * 0.02; // 2% of balance
          feedback = '‚ö†Ô∏è LATE SUBMISSION: ' + feedback + ' A 2% fine has been deducted from your balance.';
        }
      } 
      // Subsequent tasks - reject with valid reasons
      else {
        score = Math.floor(Math.random() * 21) + 30; // 30-50%
        payment = 0;
        status = 'rejected';
        
        const rejectionReasons = [
          {
            feedback: 'Submission does not meet quality standards',
            detailedFeedback: [
              { category: 'Content Quality', score: Math.floor(score * 0.8), comment: 'Content lacks coherence and logical flow. Many ideas are disconnected.' },
              { category: 'Grammar & Spelling', score: Math.floor(score * 0.7), comment: 'Numerous grammatical errors and spelling mistakes throughout.' },
              { category: 'Task Relevance', score: Math.floor(score * 0.6), comment: 'Does not address the core task requirements. Off-topic content.' },
              { category: 'Creativity', score: Math.floor(score * 0.5), comment: 'Generic content with no original thought or creative approach.' }
            ]
          },
          {
            feedback: 'Plagiarism detected or AI-generated content suspected',
            detailedFeedback: [
              { category: 'Originality Check', score: 25, comment: 'Content matches existing online sources. This is unacceptable.' },
              { category: 'Writing Style', score: Math.floor(score * 0.8), comment: 'Inconsistent writing style suggests multiple sources or AI generation.' },
              { category: 'Task Relevance', score: Math.floor(score * 0.9), comment: 'While relevant, the work is not original.' },
              { category: 'Authenticity', score: 20, comment: 'Failed authenticity verification. Resubmit original work only.' }
            ]
          },
          {
            feedback: 'Insufficient word count and shallow analysis',
            detailedFeedback: [
              { category: 'Word Count', score: 35, comment: `Only ${Math.floor(wordCount * 0.7)} quality words. Many filler words detected.` },
              { category: 'Depth of Analysis', score: Math.floor(score * 0.6), comment: 'Surface-level discussion. No in-depth exploration of themes.' },
              { category: 'Examples & Evidence', score: Math.floor(score * 0.7), comment: 'Lacks supporting examples and evidence for claims made.' },
              { category: 'Critical Thinking', score: Math.floor(score * 0.5), comment: 'No critical analysis or personal insights demonstrated.' }
            ]
          },
          {
            feedback: 'Does not follow task instructions properly',
            detailedFeedback: [
              { category: 'Instruction Adherence', score: 30, comment: 'Failed to follow the specific guidelines provided in task description.' },
              { category: 'Format & Structure', score: Math.floor(score * 0.8), comment: 'Improper formatting. Does not match required structure.' },
              { category: 'Content Accuracy', score: Math.floor(score * 0.7), comment: 'Several factual errors related to the source material.' },
              { category: 'Completeness', score: Math.floor(score * 0.6), comment: 'Missing key sections required by the task brief.' }
            ]
          }
        ];
        
        const selectedRejection = rejectionReasons[Math.floor(Math.random() * rejectionReasons.length)];
        feedback = selectedRejection.feedback;
        detailedFeedback = selectedRejection.detailedFeedback;
      }
      
      // Save submission
      const submission = {
        ...submissionData,
        taskId: task?.id || 'Unknown',
        wordCount: wordCount,
        taskTitle: task?.title || 'Unknown',
        taskPayment: task?.payment || 0,
        actualPayment: payment,
        submittedAt: new Date().toISOString(),
        reviewedAt: new Date().toISOString(),
        status: status,
        score: score,
        feedback: feedback,
        detailedFeedback: detailedFeedback
      };
      
      submissions.push(submission);
      saveToLocalStorage('submissions', submissions);
      
      // Update earnings if approved
      if (status === 'completed' && payment > 0) {
        totalEarnings += payment;
        
        // Deduct late fine if applicable
        if (lateFine > 0) {
          totalEarnings -= lateFine;
          
          // Add late fine transaction
          const transactions = getFromLocalStorage('transactions') || [];
          transactions.unshift({
            type: 'late_fine',
            amount: lateFine,
            description: 'Late Submission Fine',
            details: `2% penalty for ${task?.title || 'task'}`,
            date: new Date().toISOString()
          });
          saveToLocalStorage('transactions', transactions);
        }
        
        saveToLocalStorage('earnings', totalEarnings);
        updateBalanceDisplay();
        
        // Add to transactions
        const transactions = getFromLocalStorage('transactions') || [];
        transactions.unshift({
          type: 'task_payment',
          amount: payment,
          description: task?.title || 'Task Completed',
          details: `Score: ${score}%`,
          date: new Date().toISOString()
        });
        saveToLocalStorage('transactions', transactions);
        updateActivityList();
      }
      
      // Display results
      const resultsDiv = document.getElementById('review-results');
      const statusColor = status === 'completed' ? 'green' : 'red';
      const statusIcon = status === 'completed' ? 
        '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>' :
        '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"/>';
      
      resultsDiv.innerHTML = `
        <div class="card-soft-${status === 'completed' ? '1' : '2'} rounded-2xl p-6">
          <div class="flex items-center gap-3 mb-4">
            <div class="w-12 h-12 bg-${statusColor}-100 rounded-xl flex items-center justify-center">
              <svg class="w-7 h-7 text-${statusColor}-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                ${statusIcon}
              </svg>
            </div>
            <div>
              <h3 class="font-bold text-lg text-gray-900">${status === 'completed' ? 'Task Approved!' : 'Task Rejected'}</h3>
              <p class="text-sm text-gray-500">Score: ${score}%</p>
            </div>
          </div>
          
          <p class="text-gray-700 mb-4">${feedback}</p>
          
          <div class="space-y-3 mb-4">
            ${detailedFeedback.map(item => `
              <div class="bg-white rounded-xl p-3">
                <div class="flex justify-between items-center mb-1">
                  <span class="font-medium text-gray-700 text-sm">${item.category}</span>
                  <span class="font-bold ${item.score >= 60 ? 'text-green-600' : 'text-red-600'}">${item.score}%</span>
                </div>
                <p class="text-xs text-gray-500">${item.comment}</p>
              </div>
            `).join('')}
          </div>
          
          ${status === 'completed' ? `
            <div class="bg-green-50 border-2 border-green-200 rounded-xl p-4 mb-4">
              <p class="text-green-900 font-bold text-lg">Payment: $${payment.toFixed(2)} (KES ${(payment * EXCHANGE_RATE).toFixed(0)})</p>
              <p class="text-green-700 text-sm">Added to your balance</p>
            </div>
            ${lateFine > 0 ? `
              <div class="bg-orange-50 border-2 border-orange-200 rounded-xl p-4 mb-4">
                <p class="text-orange-900 font-bold">‚ö†Ô∏è Late Submission Fine: -$${lateFine.toFixed(2)}</p>
                <p class="text-orange-700 text-sm">2% deducted from your account balance</p>
              </div>
            ` : ''}
          ` : `
            <div class="bg-red-50 border-2 border-red-200 rounded-xl p-4 mb-4">
              <p class="text-red-900 font-bold">No payment issued</p>
              <p class="text-red-700 text-sm">Please improve and try again with a new task</p>
            </div>
          `}
          
          <button onclick="closeLiveReview()" class="w-full btn-primary text-white py-3 rounded-xl font-bold">
            Close
          </button>
        </div>
      `;
      
      resultsDiv.classList.remove('hidden');
    }
    
    function closeLiveReview() {
      document.getElementById('live-review-modal').classList.add('hidden');
      
      // Reset form
      const form = document.getElementById('submit-task-form');
      form.reset();
      document.getElementById('task-info-display').classList.add('hidden');
      document.getElementById('word-count-display').textContent = '0';
      document.getElementById('word-count-progress').style.width = '0%';
      document.getElementById('word-count-status').textContent = 'Start typing to count words';
      localStorage.removeItem('creativepay_currentSubmissionTask');
      
      // Navigate to home
      setActiveSection('home');
      showToast('Review complete!');
    }
    
    // My Tasks Modal Functions
    function showMyTasks() {
      const submissions = getFromLocalStorage('submissions') || [];
      const listContainer = document.getElementById('my-tasks-list');
      
      if (submissions.length === 0) {
        listContainer.innerHTML = `
          <div class="text-center py-12">
            <div class="w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
              <svg class="w-8 h-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
              </svg>
            </div>
            <p class="text-gray-500">No tasks submitted yet</p>
            <button onclick="closeMyTasksModal(); setActiveSection('tasks');" class="mt-4 btn-primary text-white px-6 py-2 rounded-xl font-semibold">
              Browse Tasks
            </button>
          </div>
        `;
      } else {
        listContainer.innerHTML = submissions.slice().reverse().map((sub, index) => {
          const statusColors = {
            'completed': { bg: 'card-soft-1', badge: 'bg-green-100 text-green-700', icon: 'text-green-500' },
            'rejected': { bg: 'card-soft-2', badge: 'bg-red-100 text-red-700', icon: 'text-red-500' },
            'pending': { bg: 'card-soft-3', badge: 'bg-yellow-100 text-yellow-700', icon: 'text-yellow-500' }
          };
          
          const colors = statusColors[sub.status] || statusColors['pending'];
          const statusText = sub.status === 'completed' ? 'Approved' : sub.status === 'rejected' ? 'Rejected' : 'Pending';
          
          return `
            <div class="${colors.bg} rounded-2xl p-5">
              <div class="flex justify-between items-start mb-3">
                <div class="flex-1">
                  <h3 class="font-bold text-gray-900">${sub.taskTitle}</h3>
                  <p class="text-sm text-gray-500">Submitted: ${new Date(sub.submittedAt).toLocaleString()}</p>
                </div>
                <span class="${colors.badge} px-3 py-1 rounded-full text-xs font-bold">${statusText}</span>
              </div>
              
              <div class="grid grid-cols-2 gap-3 text-sm mb-3">
                <div>
                  <p class="text-gray-500">Word Count</p>
                  <p class="font-semibold">${sub.wordCount}</p>
                </div>
                <div>
                  <p class="text-gray-500">Score</p>
                  <p class="font-semibold">${sub.score ? sub.score + '%' : 'Pending'}</p>
                </div>
              </div>
              
              ${sub.status !== 'pending' ? `
                <div class="bg-white rounded-xl p-3 mb-3">
                  <p class="text-xs font-semibold text-gray-700 mb-1">Feedback:</p>
                  <p class="text-xs text-gray-600">${sub.feedback || 'No feedback available'}</p>
                </div>
                
                ${sub.detailedFeedback ? `
                  <div class="space-y-2 mb-3">
                    ${sub.detailedFeedback.slice(0, 2).map(item => `
                      <div class="bg-white rounded-lg p-2">
                        <div class="flex justify-between items-center">
                          <span class="text-xs font-medium text-gray-700">${item.category}</span>
                          <span class="text-xs font-bold ${item.score >= 60 ? 'text-green-600' : 'text-red-600'}">${item.score}%</span>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">${item.comment}</p>
                      </div>
                    `).join('')}
                  </div>
                ` : ''}
                
                <div class="flex justify-between items-center pt-3 border-t border-gray-200">
                  <span class="text-sm text-gray-600">Payment:</span>
                  <span class="font-bold ${sub.status === 'completed' ? 'text-green-600' : 'text-red-600'}">
                    ${sub.status === 'completed' ? `$${sub.actualPayment.toFixed(2)}` : '$0.00'}
                  </span>
                </div>
              ` : `
                <div class="flex items-center gap-2 text-sm text-gray-500">
                  <div class="w-4 h-4 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"></div>
                  <span>Review in progress...</span>
                </div>
              `}
            </div>
          `;
        }).join('');
      }
      
      document.getElementById('my-tasks-modal').classList.remove('hidden');
    }
    
    function closeMyTasksModal() {
      document.getElementById('my-tasks-modal').classList.add('hidden');
    }
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9c5fd185260a73f0',t:'MTc2OTc2NDA0MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>